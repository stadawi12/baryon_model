(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     75245,       1784]
NotebookOptionsPosition[     74923,       1770]
NotebookOutlinePosition[     75287,       1786]
CellTagsIndexPosition[     75244,       1783]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"theta", ",", "TalmiMatrix", ",", " ", "talmi"}], "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"theta", "[", 
    RowBox[{"i_", ",", "m1_", ",", "m2_", ",", "m3_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Theta", " ", "can", " ", "either", " ", "be", " ", "1", " ", "or", " ", 
      "2"}], ",", " ", 
     RowBox[{"1", " ", "means", " ", "system", " ", "23"}], ",", " ", 
     RowBox[{"2", " ", "means", " ", "system", " ", "31"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "tan", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "1"}], ",", 
        RowBox[{"tan", "=", 
         RowBox[{"-", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m2", "*", 
              RowBox[{"(", 
               RowBox[{"m1", "+", "m2", "+", "m3"}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"m1", "*", "m3"}], ")"}]}], "]"}]}]}], ",", 
        RowBox[{"tan", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m1", "*", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2", "+", "m3"}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"m2", "*", "m3"}], ")"}]}], "]"}]}]}], "]"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"ArcTan", "[", "tan", "]"}], "+", "Pi"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nineJ", "[", 
    RowBox[{
    "j1_", ",", "j2_", ",", "j4_", ",", "j5_", ",", "x_", ",", "L_", ",", 
     "l_", ",", "\[CapitalLambda]_", ",", "l1_", ",", "l2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"2", "*", "x"}], ")"}]}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "x"}], "+", "1"}], ")"}], "*", 
    RowBox[{"SixJSymbol", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j1", ",", "j4", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "\[CapitalLambda]", ",", "x"}], "}"}]}], "]"}], "*", 
    
    RowBox[{"SixJSymbol", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j2", ",", "j5", ",", "l"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j4", ",", "x", ",", "l2"}], "}"}]}], "]"}], "*", 
    RowBox[{"SixJSymbol", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l1", ",", "l2", ",", "\[CapitalLambda]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "j1", ",", "j2"}], "}"}]}], "]"}]}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"talmi", "[", 
    RowBox[{
    "n1_", ",", "l1_", ",", "n2_", ",", "l2_", ",", "n_", ",", "l_", ",", 
     "nN_", ",", "L_", ",", "\[CapitalLambda]_", ",", "m1_", ",", "m2_", ",", 
     "m3_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"talmi", "[", 
     RowBox[{
     "n1", ",", "l1", ",", "n2", ",", "l2", ",", "n", ",", "l", ",", "nN", 
      ",", "L", ",", "\[CapitalLambda]", ",", "m1", ",", "m2", ",", "m3", ",",
       "\[Theta]"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fMatrix", ",", "ListOfFs", ",", "aMatrix", ",", "amin", ",", "bmin", 
        ",", "cmin", ",", "dmin", ",", "SummationVariables", ",", "a", ",", 
        "b", ",", "c", ",", "d", ",", "la", ",", "lb", ",", "lc", ",", "ld", 
        ",", "sum", ",", "coeff", ",", "y", ",", "t", ",", "i", ",", "J"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fMatrix", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "2", ",", "1", ",", "0", ",", "0", ",", "0", 
            ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "2", ",", "1", ",", "0", 
            ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "2", 
            ",", "1"}], "}"}]}], "}"}]}], ";", 
       RowBox[{"ListOfFs", "=", 
        RowBox[{"fMatrix", ".", 
         RowBox[{"{", 
          RowBox[{
          "n1", ",", "l1", ",", "n2", ",", "l2", ",", "nN", ",", "L", ",", 
           "n", ",", "l"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"aMatrix", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "2", ",", "2", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", 
            ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "2", ",", "2", ",", "0", ",", "0", ",", "1", 
            ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "2", ",", "0", ",", "2", ",", "0", ",", "1", ",", "0", ",", "1", 
            ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "2", ",", "0", ",", "2", ",", "0", ",", "1", ",", "0", 
            ",", "1"}], "}"}]}], "}"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", 
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"amin", "=", 
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"amin", "=", 
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", 
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{"bmin", "=", 
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"bmin", "=", 
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "<", 
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"cmin", "=", 
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"cmin", "=", 
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "<", 
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ",", 
         RowBox[{"dmin", "=", 
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"dmin", "=", 
          RowBox[{"ListOfFs", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], "]"}], ";", 
       RowBox[{"SummationVariables", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"a", "=", "0"}], ",", 
         RowBox[{"a", "<", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{"amin", "/", "2"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"a", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"b", "=", "0"}], ",", 
           RowBox[{"b", "<", 
            RowBox[{
             RowBox[{"Floor", "[", 
              RowBox[{"bmin", "/", "2"}], "]"}], "+", "1"}]}], ",", 
           RowBox[{"b", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"c", "=", "0"}], ",", 
             RowBox[{"c", "<", 
              RowBox[{
               RowBox[{"Floor", "[", 
                RowBox[{"cmin", "/", "2"}], "]"}], "+", "1"}]}], ",", 
             RowBox[{"c", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"d", "=", "0"}], ",", 
               RowBox[{"d", "<", 
                RowBox[{
                 RowBox[{"Floor", "[", 
                  RowBox[{"dmin", "/", "2"}], "]"}], "+", "1"}]}], ",", 
               RowBox[{"d", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"la", "=", "0"}], ",", 
                 RowBox[{"la", "<", 
                  RowBox[{"amin", "+", "1"}]}], ",", 
                 RowBox[{"la", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"lb", "=", "0"}], ",", 
                   RowBox[{"lb", "<", 
                    RowBox[{"bmin", "+", "1"}]}], ",", 
                   RowBox[{"lb", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"lc", "=", "0"}], ",", 
                    RowBox[{"lc", "<", 
                    RowBox[{"cmin", "+", "1"}]}], ",", 
                    RowBox[{"lc", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ld", "=", "0"}], ",", 
                    RowBox[{"ld", "<", 
                    RowBox[{"dmin", "+", "1"}]}], ",", 
                    RowBox[{"ld", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"aMatrix", ".", 
                    RowBox[{"{", 
                    RowBox[{
                    "a", ",", "b", ",", "c", ",", "d", ",", "la", ",", "lb", 
                    ",", "lc", ",", "ld"}], "}"}]}], "\[Equal]", "ListOfFs"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"la", "-", "lc"}], "]"}], ",", 
                    RowBox[{"la", "+", "lc"}]}], "]"}], ",", "L"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"lb", "-", "ld"}], "]"}], ",", 
                    RowBox[{"lb", "+", "ld"}]}], "]"}], ",", "l"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"la", "-", "lb"}], "]"}], ",", 
                    RowBox[{"la", "+", "lb"}]}], "]"}], ",", "l1"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"lc", "-", "ld"}], "]"}], ",", 
                    RowBox[{"lc", "+", "ld"}]}], "]"}], ",", "l2"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", 
                    RowBox[{"la", "+", "lc", "+", "L"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", 
                    RowBox[{"lb", "+", "ld", "+", "l"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", 
                    RowBox[{"la", "+", "lb", "+", "l1"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", 
                    RowBox[{"lc", "+", "ld", "+", "l2"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"SummationVariables", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "a", ",", "b", ",", "c", ",", "d", ",", "la", ",", "lb", 
                    ",", "lc", ",", "ld"}], "}"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
              "]"}]}], "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sum", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"coeff", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"I", "^", 
            RowBox[{"(", 
             RowBox[{"l1", "+", "l2", "+", "L", "+", "l"}], ")"}]}], "*", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"n1", "!"}], "*", 
             RowBox[{"n2", "!"}], "*", 
             RowBox[{"nN", "!"}], "*", 
             RowBox[{"n", "!"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", 
                 RowBox[{"(", 
                  RowBox[{"n1", "+", "l1"}], ")"}]}], "+", "1"}], ")"}], 
              "!!"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", 
                 RowBox[{"(", 
                  RowBox[{"n2", "+", "l2"}], ")"}]}], "+", "1"}], ")"}], 
              "!!"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", 
                 RowBox[{"(", 
                  RowBox[{"nN", "+", "L"}], ")"}]}], "+", "1"}], ")"}], 
              "!!"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", 
                 RowBox[{"(", 
                  RowBox[{"n", "+", "l"}], ")"}]}], "+", "1"}], ")"}], 
              "!!"}]}], "]"}]}], ")"}], "/", 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"l1", "+", "l2", "+", "L", "+", "l"}], ")"}], "/", "4"}],
            ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "SummationVariables", "]"}], "+", "1"}]}], 
         ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{
          RowBox[{"J", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SummationVariables", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "5"}], "]"}], "]"}], ",", 
             RowBox[{"SummationVariables", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "6"}], "]"}], "]"}], ",", "l1", ",", 
             RowBox[{"SummationVariables", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "7"}], "]"}], "]"}], ",", 
             RowBox[{"SummationVariables", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "8"}], "]"}], "]"}], ",", "l2", ",", "L", 
             ",", "l", ",", "\[CapitalLambda]"}], "}"}]}], ";", 
          RowBox[{"a", "=", 
           RowBox[{"SummationVariables", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"b", "=", 
           RowBox[{"SummationVariables", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"c", "=", 
           RowBox[{"SummationVariables", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"d", "=", 
           RowBox[{"SummationVariables", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ";", 
          RowBox[{"la", "=", 
           RowBox[{"J", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", 
          RowBox[{"lb", "=", 
           RowBox[{"J", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", 
          RowBox[{"lc", "=", 
           RowBox[{"J", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], ";", 
          RowBox[{"ld", "=", 
           RowBox[{"J", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"y", "=", 
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"la", "-", "\[CapitalLambda]"}], "]"}], ",", 
               RowBox[{"la", "+", "\[CapitalLambda]"}]}], "]"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"l", "-", "lc"}], "]"}], ",", 
               RowBox[{"l", "+", "lc"}]}], "]"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"lb", "-", "l2"}], "]"}], ",", 
               RowBox[{"lb", "+", "l2"}]}], "]"}]}], "]"}]}], ";", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"sum", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"la", "+", "lb", "+", "lc"}], ")"}]}], "*", 
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"la", "+", "lb", "+", "lc", "+", "ld"}], ")"}], "/", 
                "2"}], ")"}]}], "*", 
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"theta", "[", 
                RowBox[{"\[Theta]", ",", "m1", ",", "m2", ",", "m3"}], "]"}], 
               "]"}], "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", "a"}], "+", "la", "+", 
                RowBox[{"2", "*", "d"}], "+", "ld"}], ")"}]}], "*", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"theta", "[", 
                RowBox[{"\[Theta]", ",", "m1", ",", "m2", ",", "m3"}], "]"}], 
               "]"}], "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", "b"}], "+", "lb", "+", 
                RowBox[{"2", "*", "c"}], "+", "lc"}], ")"}]}], "*", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"nineJ", "[", 
                RowBox[{"la", ",", "lb", ",", "lc", ",", "ld", ",", 
                 RowBox[{"y", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "L", ",", "l", ",", 
                 "\[CapitalLambda]", ",", "l1", ",", "l2"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "y", "]"}]}], "}"}]}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", "la"}], "+", "1"}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", "lb"}], "+", "1"}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", "lc"}], "+", "1"}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", "ld"}], "+", "1"}], ")"}]}], ")"}], "/", 
               
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"a", "!"}], "*", 
                 RowBox[{"b", "!"}], "*", 
                 RowBox[{"c", "!"}], "*", 
                 RowBox[{"d", "!"}], "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{"a", "+", "la"}], ")"}]}], "+", "1"}], ")"}], 
                  "!!"}], "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{"b", "+", "lb"}], ")"}]}], "+", "1"}], ")"}], 
                  "!!"}], "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{"c", "+", "lc"}], ")"}]}], "+", "1"}], ")"}], 
                  "!!"}], "*", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", 
                    RowBox[{"(", 
                    RowBox[{"d", "+", "ld"}], ")"}]}], "+", "1"}], ")"}], 
                  "!!"}]}], ")"}]}], ")"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"la", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"lc", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"L", ",", "0"}], "}"}]}], "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"lb", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"ld", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", "0"}], "}"}]}], "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"la", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"lb", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "0"}], "}"}]}], "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"lc", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"ld", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l2", ",", "0"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
        "]"}], ";", 
       RowBox[{"t", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", 
          RowBox[{"(", 
           RowBox[{"l", "+", "L", "-", "\[CapitalLambda]"}], ")"}]}], "*", 
         RowBox[{"Total", "[", "sum", "]"}], "*", "coeff"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sumArgs", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nlist", ",", "llist", ",", "n", ",", "l", ",", "i", ",", "j", ",", "k",
        ",", "m", ",", "sArgs"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nlist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"llist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "*", "n"}], "\[LessEqual]", "\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"nlist", ",", "n"}], "]"}], ";", 
         RowBox[{"n", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"l", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"l", "\[LessEqual]", "\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"llist", ",", "l"}], "]"}], ";", 
         RowBox[{"l", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sArgs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "nlist", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"Length", "[", "llist", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", 
             RowBox[{"Length", "[", "nlist", "]"}]}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"m", "=", "1"}], ",", 
              RowBox[{"m", "\[LessEqual]", 
               RowBox[{"Length", "[", "llist", "]"}]}], ",", 
              RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"2", "*", 
                   RowBox[{"nlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                  RowBox[{"llist", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "+", 
                  RowBox[{"2", "*", 
                   RowBox[{"nlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "+", 
                  RowBox[{"llist", "[", 
                   RowBox[{"[", "m", "]"}], "]"}]}], "\[Equal]", "\[Gamma]"}],
                 ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"lvals", ",", 
                    RowBox[{"{", 
                    RowBox[{"lvals", ",", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"llist", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                    RowBox[{"llist", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"llist", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", 
                    RowBox[{"llist", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
                    "\[CapitalLambda]"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"sArgs", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"llist", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"nlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"llist", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "}"}]}], "]"}]}], 
                 "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "sArgs", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"talmiCoeffs", "[", 
    RowBox[{
    "n1_", ",", "l1_", ",", "n2_", ",", "l2_", ",", "\[CapitalLambda]_", ",", 
     "m1_", ",", "m2_", ",", "m3_", ",", "\[Theta]_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "coeffs", ",", "\[Gamma]", ",", "args", ",", "wuba", ",", "nN", ",", 
       "lL", ",", "nn", ",", "ll", ",", "coeff2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coeffs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]", "=", 
       RowBox[{
        RowBox[{"2", "*", "n1"}], "+", "l1", "+", 
        RowBox[{"2", "*", "n2"}], "+", "l2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"args", "=", 
       RowBox[{"sumArgs", "[", 
        RowBox[{"\[CapitalLambda]", ",", "\[Gamma]"}], "]"}]}], ";", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"wuba", "=", "1"}], ",", 
        RowBox[{"wuba", "<", 
         RowBox[{
          RowBox[{"Length", "[", "args", "]"}], "+", "1"}]}], ",", 
        RowBox[{"wuba", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nN", "=", 
          RowBox[{"args", "[", 
           RowBox[{"[", 
            RowBox[{"wuba", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lL", "=", 
          RowBox[{"args", "[", 
           RowBox[{"[", 
            RowBox[{"wuba", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nn", "=", 
          RowBox[{"args", "[", 
           RowBox[{"[", 
            RowBox[{"wuba", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ll", "=", 
          RowBox[{"args", "[", 
           RowBox[{"[", 
            RowBox[{"wuba", ",", "4"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"coeff2", "=", 
          RowBox[{"talmi", "[", 
           RowBox[{
           "n1", ",", "l1", ",", "n2", ",", "l2", ",", "nN", ",", "lL", ",", 
            "nn", ",", "ll", ",", "\[CapitalLambda]", ",", "m1", ",", "m2", 
            ",", "m3", ",", "\[Theta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"coeff2", "\[NotEqual]", "0"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"coeffs", ",", 
             RowBox[{"{", 
              RowBox[{"coeff2", ",", 
               RowBox[{"args", "[", 
                RowBox[{"[", "wuba", "]"}], "]"}]}], "}"}]}], "]"}]}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "coeffs", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tBlock", "[", 
    RowBox[{
    "\[CapitalLambda]_", ",", "\[Gamma]_", ",", "m1_", ",", "m2_", ",", "m3_",
      ",", "\[Theta]_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "states", ",", "mat", ",", "bin", ",", "he", ",", "be", ",", "nN", ",", 
       "L", ",", "n", ",", "l", ",", "n1", ",", "l1", ",", "n2", ",", "l2", 
       ",", "matrix"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"states", "=", 
       RowBox[{"sumArgs", "[", 
        RowBox[{"\[CapitalLambda]", ",", "\[Gamma]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"states", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"states", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "states", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bin", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"he", "=", "1"}], ",", 
        RowBox[{"he", "\[LessEqual]", 
         RowBox[{"Length", "[", "states", "]"}]}], ",", 
        RowBox[{"he", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"be", "=", "1"}], ",", 
          RowBox[{"be", "\[LessEqual]", 
           RowBox[{"Length", "[", "states", "]"}]}], ",", 
          RowBox[{"be", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nN", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "1", ",", "1"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"L", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "1", ",", "2"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"n", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "1", ",", "3"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"l", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "1", ",", "4"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"n1", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "2", ",", "1"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"l1", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "2", ",", "2"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"n2", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "2", ",", "3"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"l2", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "2", ",", "4"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"bin", ",", 
             RowBox[{
              RowBox[{"talmi", "[", 
               RowBox[{
               "n1", ",", "l1", ",", "n2", ",", "l2", ",", "nN", ",", "L", 
                ",", "n", ",", "l", ",", "\[CapitalLambda]", ",", "m1", ",", 
                "m2", ",", "m3", ",", "\[Theta]"}], "]"}], "*", "1."}]}], 
            "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"matrix", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"bin", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "states", "]"}], ",", 
           RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "matrix", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tMatrix", "[", 
    RowBox[{
    "\[CapitalLambda]_", ",", "\[Gamma]Max_", ",", "m1_", ",", "m2_", ",", 
     "m3_", ",", "\[Theta]_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Gamma]MinEven", ",", "\[Gamma]MinOdd", ",", "energies", ",", 
       "blocks"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]MinEven", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"EvenQ", "[", "\[CapitalLambda]", "]"}], ",", 
         "\[CapitalLambda]", ",", 
         RowBox[{"\[CapitalLambda]", "+", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]MinOdd", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"EvenQ", "[", "\[CapitalLambda]", "]"}], ",", 
         RowBox[{"\[CapitalLambda]", "+", "1"}], ",", "\[CapitalLambda]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"energies", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"EvenQ", "[", "\[Gamma]Max", "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{"n", ",", 
           RowBox[{"{", 
            RowBox[{
            "n", ",", "\[Gamma]MinEven", ",", "\[Gamma]Max", ",", "2"}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{"n", ",", 
           RowBox[{"{", 
            RowBox[{
            "n", ",", "\[Gamma]MinOdd", ",", "\[Gamma]Max", ",", "2"}], 
            "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"blocks", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tBlock", "[", 
           RowBox[{
           "\[CapitalLambda]", ",", "#", ",", "m1", ",", "m2", ",", "m3", ",",
             "\[Theta]"}], "]"}], "&"}], ",", "energies"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"ReleaseHold", "[", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"Hold", "/@", "blocks"}], "]"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CombineEnergies", "[", 
    RowBox[{"P_", ",", "L_", ",", "\[Gamma]Max_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Set", " ", "local", " ", "parameters"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "allStates", ",", "\[Gamma]", ",", "states", ",", "state", ",", 
       "startPoint"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Create", " ", "bin", " ", "for", " ", "storing", " ", "states", " ", 
       "with", " ", "all", " ", "energies"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"allStates", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Determine", " ", "energy", " ", "start", " ", "point", " ", 
        "depending", " ", "on", " ", "parity"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"P", "\[Equal]", "1"}], ",", 
        RowBox[{"startPoint", "=", "0"}], ",", 
        RowBox[{"startPoint", "=", "1"}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Loop", " ", "over", " ", "all", " ", "energies"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"\[Gamma]", "=", "startPoint"}], ",", 
        RowBox[{"\[Gamma]", "\[LessEqual]", "\[Gamma]Max"}], ",", 
        RowBox[{"\[Gamma]", "+=", "2"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Generate", " ", "states", " ", "for", " ", "particular", " ", 
          "energy", " ", "\[Gamma]"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"states", "=", 
          RowBox[{"sumArgs", "[", 
           RowBox[{"L", ",", "\[Gamma]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Add", " ", "each", " ", "basis", " ", "from", " ", "states", " ", 
           "individually", " ", "to", " ", "allStates"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"state", "=", "1"}], ",", 
           RowBox[{"state", "\[LessEqual]", 
            RowBox[{"Length", "[", "states", "]"}]}], ",", 
           RowBox[{"state", "++"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Append", " ", "each", " ", "state", " ", "into", " ", "all", " ",
              "States", " ", "and", " ", "append", " ", "the", " ", "L", " ", 
             "quantum", " ", "number"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"allStates", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"states", "[", 
                 RowBox[{"[", "state", "]"}], "]"}], ",", "L"}], "}"}], 
              "]"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "]"}]}]}], 
       RowBox[{"(*", " ", 
        RowBox[{"End", " ", "of", " ", "state", " ", "loop"}], " ", "*)"}], 
       "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", " ", 
       RowBox[{"End", " ", "of", " ", "\[Gamma]", " ", "loop"}], " ", "*)"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "allStates", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddSpin", "[", 
    RowBox[{"J_", ",", "P_", ",", "L_", ",", "\[Gamma]Max_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "spinlessStates", ",", "spinBasis12", ",", "spinBasis32", ",", "i", ",",
        "j", ",", "spinlessState", ",", "spinBaseFunction", ",", 
       "combinedState", ",", "combinedStates", ",", "s12", ",", "s32", ",", 
       "Jmin12", ",", "Jmax12", ",", "Jlist12", ",", "Jmin32", ",", "Jmax32", 
       ",", "Jlist32"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Generate", " ", "basis", " ", "states", " ", "without", " ", "spin"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spinlessStates", "=", 
       RowBox[{"CombineEnergies", "[", 
        RowBox[{"P", ",", "L", ",", "\[Gamma]Max"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Define", " ", "spin", " ", "basis", " ", "states"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"spinBasis12", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           FractionBox["1", "2"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           FractionBox["1", "2"]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"spinBasis32", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["3", "2"]}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"combinedStates", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"s12", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"s32", "=", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Calculate", " ", "possible", " ", 
         RowBox[{"J", "'"}], "s", " ", "that", " ", "L", " ", "and", " ", "S",
          " ", "can", " ", "couple", " ", "to", " ", "given", " ", "S"}], "=", 
        RowBox[{"1", "/", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Jmin12", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"L", "-", 
         FractionBox["1", "2"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Jmax12", "=", 
       RowBox[{"L", "+", 
        FractionBox["1", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Jlist12", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"totalJ", ",", 
         RowBox[{"{", 
          RowBox[{"totalJ", ",", "Jmin12", ",", "Jmax12"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Calculate", " ", "possible", " ", 
         RowBox[{"J", "'"}], "s", " ", "that", " ", "L", " ", "and", " ", "S",
          " ", "can", " ", "couple", " ", "to", " ", "given", " ", "S"}], "=", 
        RowBox[{"3", "/", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Jmin32", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"L", "-", 
         FractionBox["3", "2"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Jmax32", "=", 
       RowBox[{"L", "+", 
        FractionBox["3", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Jlist32", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"totalJ", ",", 
         RowBox[{"{", 
          RowBox[{"totalJ", ",", "Jmin32", ",", "Jmax32"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Attach", " ", "spin", " ", "to", " ", "the", " ", "spinless", " ", 
        "basis", " ", "states"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "spinlessStates", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"Length", "[", "spinBasis12", "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"Jlist12", ",", "J"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"spinlessState", "=", 
               RowBox[{"spinlessStates", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"spinBaseFunction", "=", 
               RowBox[{"spinBasis12", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"combinedState", "=", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"spinlessState", ",", "spinBaseFunction"}], "]"}], "//",
                 "Flatten"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"combinedStates", ",", "combinedState"}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}]}], 
          RowBox[{"(*", " ", 
           RowBox[{"End", " ", "of", " ", "If", " ", "statement"}], " ", 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
         RowBox[{"(*", " ", 
          RowBox[{"End", " ", "of", " ", "j", " ", "loop"}], " ", "*)"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"Jlist32", ",", "J"}], "]"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{"spinlessState", "=", 
             RowBox[{"spinlessStates", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"spinBaseFunction", "=", "spinBasis32"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"combinedState", "=", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"spinlessState", ",", "spinBaseFunction"}], "]"}], "//",
               "Flatten"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"combinedStates", ",", "combinedState"}], "]"}], ";"}]}],
           "\[IndentingNewLine]", "]"}]}]}], 
       RowBox[{"(*", " ", 
        RowBox[{"End", " ", "of", " ", "if", " ", "statement"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", " ", 
       RowBox[{"End", " ", "of", " ", "i", " ", "loop"}], " ", "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "combinedStates", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stateMatrix", "[", 
    RowBox[{"J_", ",", "P_", ",", "L_", ",", "\[Gamma]Max_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Produces", " ", "matrix", " ", "of", " ", "states", " ", "with", " ", 
     "the", " ", "ordering", " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["n", "\[Rho]"], ",", 
       SubscriptBox["l", "\[Rho]"], ",", 
       SubscriptBox["n", "\[Lambda]"], ",", 
       SubscriptBox["l", "\[Lambda]"], ",", "L", ",", 
       SubscriptBox["s", "12"], ",", "s"}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"states", ",", "matrixOfStates"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Generate", " ", "all", " ", "possible", " ", "states"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"states", "=", 
       RowBox[{"AddSpin", "[", 
        RowBox[{"J", ",", "P", ",", "L", ",", "\[Gamma]Max"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Make", " ", "a", " ", "matrix", " ", "out", " ", "of", " ", 
        "states"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"matrixOfStates", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"states", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"states", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "states", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "matrixOfStates", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TalmiMatrix", "[", 
    RowBox[{
    "J_", ",", "P_", ",", "L_", ",", "\[Gamma]Max_", ",", "m1_", ",", "m2_", 
     ",", "m3_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"TalmiMatrix", "[", 
     RowBox[{
     "J", ",", "P", ",", "L", ",", "\[Gamma]Max", ",", "m1", ",", "m2", ",", 
      "m3", ",", "\[Theta]"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "matrixOfStates", ",", "matrixSize", ",", "i", ",", "j", ",", 
        "talmiCoeff", ",", "stateSandwich", ",", "bra", ",", "ket", ",", 
        "talmiMatrix", ",", "nRho", ",", "lRho", ",", "nLam", ",", "lLam", 
        ",", "nRhoP", ",", "lRhoP", ",", "nLamP", ",", "lLamP"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"matrixOfStates", "=", 
        RowBox[{"stateMatrix", "[", 
         RowBox[{"J", ",", "P", ",", "L", ",", "\[Gamma]Max"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"matrixSize", "=", 
        RowBox[{"matrixOfStates", "//", "Length"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Generate", " ", "an", " ", "empty", " ", "array", " ", "for", " ", 
         "storing", " ", "tlami", " ", "coeffs"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"talmiMatrix", "=", 
        RowBox[{"Array", "[", 
         RowBox[{
          RowBox[{"0", "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"matrixSize", ",", "matrixSize"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "matrixSize"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "i"}], ",", 
           RowBox[{"j", "\[LessEqual]", "matrixSize"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Grab", " ", "the", " ", "state", " ", "sandwich"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"stateSandwich", "=", 
             RowBox[{"matrixOfStates", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"bra", "=", 
             RowBox[{"stateSandwich", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"ket", "=", 
             RowBox[{"stateSandwich", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Grab", " ", "the", " ", "bra", " ", "quantum", " ", "numbers"}],
              " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"nRho", "=", 
             RowBox[{"bra", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", 
            RowBox[{"(*", " ", 
             SubscriptBox["n", "\[Rho]"], " ", "*)"}], "\[IndentingNewLine]", 
            
            RowBox[{"lRho", "=", 
             RowBox[{"bra", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", 
            RowBox[{"(*", " ", 
             SubscriptBox["l", "\[Rho]"], " ", "*)"}], "\[IndentingNewLine]", 
            
            RowBox[{"nLam", "=", 
             RowBox[{"bra", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ";", 
            RowBox[{"(*", " ", 
             SubscriptBox["n", "\[Lambda]"], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"lLam", "=", 
             RowBox[{"bra", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], ";", 
            RowBox[{"(*", " ", 
             SubscriptBox["l", "\[Lambda]"], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Grab", " ", "the", " ", "ket", " ", "quantum", " ", "numbers"}],
              " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"nRhoP", "=", 
             RowBox[{"ket", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
              SubscriptBox["n", "\[Rho]"], "'"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"lRhoP", "=", 
             RowBox[{"ket", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
              SubscriptBox["l", "\[Rho]"], "'"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"nLamP", "=", 
             RowBox[{"ket", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
              SubscriptBox["n", "\[Lambda]"], "'"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"lLamP", "=", 
             RowBox[{"ket", "[", 
              RowBox[{"[", "4", "]"}], "]"}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
              SubscriptBox["l", "\[Lambda]"], "'"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "obtain", " ", "talmi", " ", "coefficient", " ", "for", " ", 
              "this", " ", "state", " ", "sandwich"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"talmiCoeff", "=", 
             RowBox[{"talmi", "[", 
              RowBox[{
              "nRho", ",", "lRho", ",", "nLam", ",", "lLam", ",", "nRhoP", 
               ",", "lRhoP", ",", "nLamP", ",", "lLamP", ",", "L", ",", "m1", 
               ",", "m2", ",", "m3", ",", "\[Theta]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"talmiMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "talmiCoeff"}], 
            ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
        RowBox[{"(*", " ", 
         RowBox[{"End", " ", "of", " ", "j", " ", "loop"}], " ", "*)"}], 
        "\[IndentingNewLine]", "]"}], 
       RowBox[{"(*", " ", 
        RowBox[{"End", " ", "of", " ", "i", " ", "loop"}], " ", "*)"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"talmiMatrix", "=", 
        RowBox[{"talmiMatrix", "+", 
         RowBox[{"Transpose", "[", "talmiMatrix", "]"}], "-", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"Diagonal", "[", "talmiMatrix", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "talmiMatrix", "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{
    "J_", ",", "P_", ",", "L_", ",", "\[Gamma]Max_", ",", "Isospin_"}], "]"}],
    ":=", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Spin", " ", "x", " ", "Space", " ", "x", " ", "Flavour"}], " ", 
     "=", " ", 
     RowBox[{"Symmetric", " ", 
      RowBox[{"(", 
       RowBox[{"Colour", " ", "is", " ", "Antisymmetric"}], ")"}]}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Isospin", " ", 
     RowBox[{"(", "I", ")"}], " ", "corresponds", " ", "to", " ", "parity", 
     " ", "of", " ", "Flavour"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"I", " ", "=", " ", 
      RowBox[{"0", " ", "is", " ", "Antisymmetric"}]}], ",", " ", 
     RowBox[{"I", " ", "=", " ", 
      RowBox[{"1", " ", "is", " ", "Symmetric"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"If", " ", "Flavour"}], " ", "=", " ", "Symmetric"}], ",", " ", 
     "then", ",", " ", 
     RowBox[{
      RowBox[{"Spin", " ", "x", " ", "Space"}], " ", "=", " ", 
      "Antisymmetric"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"If", " ", "Flavour"}], " ", "=", " ", "Antisymmetric"}], ",", 
     " ", "then", ",", " ", 
     RowBox[{
      RowBox[{"Spin", " ", "x", " ", "Space"}], " ", "=", " ", 
      "Symmetric"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "For", " ", "Spin", " ", "x", " ", "Space", " ", "to", " ", "be", " ", 
     "Symmetric", " ", "we", " ", "can", " ", "have", " ", 
     RowBox[{"(", 
      RowBox[{"SS", " ", "or", " ", "AA"}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "For", " ", "Spin", " ", "x", " ", "Space", " ", "to", " ", "be", " ", 
     "Antimmetric", " ", "we", " ", "can", " ", "have", " ", 
     RowBox[{"(", 
      RowBox[{"SA", " ", "or", " ", "AS"}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "flavourParity", ",", "spinSpaceParity", ",", "allStates", ",", "i", 
       ",", "state", ",", "lRho", ",", "spaceParity", ",", "spinParity", ",", 
       "s12", ",", "s12Parity", ",", "projectorList"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "Isospin", "]"}], ",", 
        RowBox[{"flavourParity", "=", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"flavourParity", "=", "1"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"flavourParity", "\[Equal]", "1"}], ",", 
        RowBox[{"spinSpaceParity", "=", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"spinSpaceParity", "=", "1"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Generate", " ", "all", " ", "states", " ", "without", " ", "worrying",
         " ", "about", " ", "parity"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"allStates", "=", 
       RowBox[{"AddSpin", "[", 
        RowBox[{"J", ",", "P", ",", "L", ",", "\[Gamma]Max"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"projectorList", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "For", " ", "each", " ", "state", " ", "in", " ", "all", " ", 
         "states"}], "..."}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "allStates", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Grab", " ", "state"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"state", "=", 
          RowBox[{"allStates", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Grab", " ", 
           SubscriptBox["l", "\[Rho]"], " ", "to", " ", "determine", " ", 
           "spatial", " ", "parity"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lRho", "=", 
          RowBox[{"state", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Grab", " ", 
           SubscriptBox["s", "12"], " ", "to", " ", "see", " ", "the", " ", 
           "spin", " ", "parity"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"s12", "=", 
          RowBox[{"state", "[", 
           RowBox[{"[", "6", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"If", " ", 
            SubscriptBox["l", "\[Rho]"], " ", "is", " ", "even", " ", "then", 
            " ", "space", " ", "is", " ", "symmetric"}], ",", " ", 
           RowBox[{"if", " ", "odd", " ", "then", " ", "antisymmetric"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"EvenQ", "[", "lRho", "]"}], ",", 
           RowBox[{"spaceParity", "=", "1"}], ",", 
           RowBox[{"spaceParity", "=", 
            RowBox[{"-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"If", " ", 
            SubscriptBox["s", "12"], " ", "is", " ", "0", " ", "then", " ", 
            "spin", " ", "is", " ", "antisymmetric"}], ",", " ", 
           RowBox[{"if", " ", "1", " ", "then", " ", "symmetric"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"s12", "\[Equal]", "0"}], ",", 
           RowBox[{"s12Parity", "=", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"s12Parity", "=", "1"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Determine", " ", "what", " ", "the", " ", "parity", " ", "of", " ",
            "spin", " ", "SHOULD", " ", "be"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"spinParity", "=", 
          RowBox[{"spinSpaceParity", "*", "spaceParity"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "If", " ", "the", " ", "parity", " ", "of", " ", "state", " ", 
            "is", " ", "what", " ", "it", " ", "should", " ", "be", " ", 
            "then", " ", "allow", " ", "that", " ", "state", 
            "\[IndentingNewLine]", "and", " ", "append", " ", "a", " ", "1", 
            " ", "to", " ", "projector", " ", "list"}], ",", " ", 
           RowBox[{"if", " ", "they", " ", "are", " ", "not", " ", "same"}], 
           ",", " ", 
           RowBox[{"append", " ", "a", " ", "0"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"s12Parity", "\[Equal]", "spinParity"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"projectorList", ",", "1"}], "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"projectorList", ",", "0"}], "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", " ", 
       RowBox[{"End", " ", "of", " ", "i", " ", "loop"}], " ", "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"projectorMatrix", "=", 
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", "projectorList", ",", "projectorList"}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{"End", " ", "of", " ", "Projector", " ", "function"}], " ", "*)"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyProjector", "[", 
    RowBox[{"matrix_", ",", "projectorMatrix_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"matrixSize", ",", "outputMatrix", ",", "i", ",", "j"}], "}"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Find", " ", "matrix", " ", "size"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"matrixSize", "=", 
       RowBox[{"Length", "[", "matrix", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Prepare", " ", "output", " ", "matrix", " ", "of", " ", "the", " ", 
        "right", " ", "size", " ", "filled", " ", "with", " ", "zeros"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"outputMatrix", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"matrixSize", ",", "matrixSize"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Superimpose", " ", "the", " ", "projector", " ", "onto", " ", "the", 
        " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "matrixSize"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", "matrixSize"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"outputMatrix", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
            RowBox[{"projectorMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
       RowBox[{"(*", " ", 
        RowBox[{"End", " ", "of", " ", "j", " ", "loop"}], " ", "*)"}], 
       "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", " ", 
       RowBox[{"End", " ", "of", " ", "i", " ", "loop"}], " ", "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "outputMatrix", "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{"End", " ", "of", " ", "ApplyProjector", " ", "function"}], " ", 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"m1", "=", "1"}], ";", 
    RowBox[{"m2", "=", "1"}], ";", 
    RowBox[{"m3", "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"J", "=", 
     FractionBox["1", "2"]}], ";", 
    RowBox[{"P", "=", "1"}], ";", 
    RowBox[{"L", "=", "0"}], ";", 
    RowBox[{"\[Gamma]Max", "=", "2"}], ";", 
    RowBox[{"Isospin", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CombineEnergies", "[", 
      RowBox[{"P", ",", "L", ",", "\[Gamma]Max"}], "]"}], "//", "Length"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"AddSpin", "[", 
     RowBox[{"J", ",", "P", ",", "L", ",", "\[Gamma]Max"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"proj", "=", 
     RowBox[{"Projector", "[", 
      RowBox[{"J", ",", "P", ",", "L", ",", "\[Gamma]Max", ",", "I"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"x", "=", 
     RowBox[{
      RowBox[{"stateMatrix", "[", 
       RowBox[{"J", ",", "P", ",", "L", ",", "\[Gamma]Max"}], "]"}], "//", 
      "MatrixForm"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"talmi", "=", 
     RowBox[{"TalmiMatrix", "[", 
      RowBox[{
      "J", ",", "P", ",", "L", ",", "\[Gamma]Max", ",", "m1", ",", "m2", ",", 
       "m3", ",", "2"}], "]"}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8145102102999*^9, 3.814510269460178*^9}, {
   3.81452268764421*^9, 3.8145226895528927`*^9}, {3.815751044279109*^9, 
   3.815751045493334*^9}, {3.8442322943449793`*^9, 3.844232296344261*^9}, {
   3.8443151403942757`*^9, 3.8443153615505447`*^9}, {3.8443153957581167`*^9, 
   3.844315504952074*^9}, {3.844315822345292*^9, 3.8443159087182302`*^9}, {
   3.844321690984358*^9, 3.844321703147876*^9}, {3.846063231465679*^9, 
   3.846063563202669*^9}, {3.846063619679188*^9, 3.8460637905338507`*^9}, {
   3.8460638208774633`*^9, 3.846064191045005*^9}, {3.846064343108227*^9, 
   3.846064378026164*^9}, {3.846064481657111*^9, 3.846064496566392*^9}, {
   3.846064530718485*^9, 3.8460645331572437`*^9}, {3.846064998767116*^9, 
   3.846065076359582*^9}, {3.8460651168872757`*^9, 3.8460651326361723`*^9}, {
   3.846065229697979*^9, 3.8460652307351*^9}, {3.8460652682729197`*^9, 
   3.8460653405565233`*^9}, {3.846065869749216*^9, 3.846065926733617*^9}, {
   3.846065981353744*^9, 3.8460660366573277`*^9}, {3.846066179987904*^9, 
   3.846066322842484*^9}, {3.846066362499093*^9, 3.846066545743704*^9}, {
   3.846066596419127*^9, 3.846066728994095*^9}, {3.846066785600973*^9, 
   3.8460667881952543`*^9}, {3.846066830360285*^9, 3.846067678977408*^9}, {
   3.846067899940935*^9, 3.846068101436018*^9}, {3.846068153997562*^9, 
   3.846068314935975*^9}, {3.846068348357937*^9, 3.846068374688077*^9}, {
   3.846068458436884*^9, 3.846068534748328*^9}, 3.846068573621327*^9, {
   3.8460686194115677`*^9, 3.846068622055832*^9}, {3.846068670847433*^9, 
   3.84606873068132*^9}, {3.846068993167313*^9, 3.846068993315261*^9}, {
   3.846069239555241*^9, 3.846069261850531*^9}, {3.8460694808367043`*^9, 
   3.846069577938216*^9}, {3.8460696280139313`*^9, 3.846069952379403*^9}, {
   3.846069984500556*^9, 3.846070217022667*^9}, {3.846070247528449*^9, 
   3.846070250608301*^9}, {3.846070303493395*^9, 3.846070327998949*^9}, {
   3.846070376403182*^9, 3.846070847405854*^9}, {3.8460710075051928`*^9, 
   3.846071178383608*^9}, {3.846071352887293*^9, 3.846071396096197*^9}, {
   3.846133506907814*^9, 3.846133507098937*^9}, {3.846138549512748*^9, 
   3.846138550208789*^9}, {3.846138644100667*^9, 3.8461386444448147`*^9}, {
   3.8461386943130198`*^9, 3.846138744065034*^9}, {3.8461387980626497`*^9, 
   3.846138805198207*^9}, {3.8461388881166897`*^9, 3.846138984095697*^9}, {
   3.8461390178102818`*^9, 3.846139020207896*^9}, {3.846139094874107*^9, 
   3.846139104926405*^9}, {3.846139147034877*^9, 3.846139238537051*^9}, {
   3.8461395006925898`*^9, 3.846139503561906*^9}, {3.846235177509691*^9, 
   3.846235228936769*^9}, {3.846235271843679*^9, 3.846235303800967*^9}, {
   3.846235346992715*^9, 3.846235374853236*^9}, {3.846237298273426*^9, 
   3.846237302377955*^9}, 3.8462407616041718`*^9, 3.846241849254026*^9, {
   3.846241897897677*^9, 3.846241901531555*^9}, {3.846242114203504*^9, 
   3.846242160719863*^9}, {3.846242365913306*^9, 3.846242683900743*^9}, {
   3.846242717442967*^9, 3.8462427755165977`*^9}, {3.846242946789743*^9, 
   3.846242987485705*^9}, {3.846243241203208*^9, 3.8462432746630507`*^9}, {
   3.846245100292088*^9, 3.846245214725675*^9}, {3.846245285063038*^9, 
   3.846245389277495*^9}, {3.846245870529841*^9, 3.846245928721571*^9}, {
   3.84624620280686*^9, 3.8462462717271967`*^9}, {3.846246319599408*^9, 
   3.846246752004321*^9}, {3.846246787806569*^9, 3.846246796063665*^9}, {
   3.846246872926424*^9, 3.846247023407957*^9}, {3.8462471133865633`*^9, 
   3.846247115724231*^9}, {3.846247315055319*^9, 3.8462473253940983`*^9}, {
   3.8462473633888683`*^9, 3.8462473669044456`*^9}, {3.8463085846588097`*^9, 
   3.8463087571331472`*^9}, {3.846308807637794*^9, 3.8463089322386007`*^9}, {
   3.8463089856293573`*^9, 3.846309008970063*^9}, {3.846309639013071*^9, 
   3.84630964119466*^9}, {3.846309901155448*^9, 3.846309901257122*^9}, {
   3.84631019061257*^9, 3.846310261656309*^9}, {3.846310329854763*^9, 
   3.8463103301169024`*^9}, {3.846310364913156*^9, 3.8463103814272738`*^9}, {
   3.846310429921999*^9, 3.846310453497876*^9}, {3.846310633090343*^9, 
   3.846310663389987*^9}, {3.846310893670556*^9, 3.8463109143450403`*^9}, {
   3.846314306691057*^9, 3.846314350461219*^9}, {3.846314386787826*^9, 
   3.8463144007239017`*^9}, {3.846314598567222*^9, 3.846314796070509*^9}, {
   3.846314837718545*^9, 3.846315344384956*^9}, {3.846315407098556*^9, 
   3.8463154615275497`*^9}, {3.84631634068265*^9, 3.8463164054297037`*^9}, {
   3.846316448753872*^9, 3.846316997450594*^9}, {3.846317075737906*^9, 
   3.846317116221368*^9}, {3.846317180834284*^9, 3.8463171830554523`*^9}, {
   3.8463225860278683`*^9, 3.8463226138636293`*^9}, {3.8463231879349003`*^9, 
   3.846323202782745*^9}, {3.846323407635538*^9, 3.846323765646583*^9}, 
   3.846323806293605*^9, {3.84632455737514*^9, 
   3.846324558840602*^9}},ExpressionUUID->"6bf8f49e-3c3d-4e9e-8365-\
db12206f4eb3"]
},
WindowSize->{1854, 1016},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 74361, 1748, 11136, "Input",ExpressionUUID->"6bf8f49e-3c3d-4e9e-8365-db12206f4eb3"]
}
]
*)

