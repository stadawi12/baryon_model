(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      5480,        144]
NotebookOptionsPosition[      5193,        131]
NotebookOutlinePosition[      5526,        146]
CellTagsIndexPosition[      5483,        143]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"expValRho", "[", 
    RowBox[{
    "J_", ",", "P_", ",", "Isospin_", ",", "\[CapitalLambda]_", ",", 
     "\[Gamma]Max_", ",", "wMin_", ",", "m1_", ",", "m2_", ",", "m3_", ",", 
     "project_", ",", "power_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "sM", ",", "observable12", ",", "observable23", ",", "observable31", 
       ",", "observables", ",", "alphas", ",", "eVec"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Get", " ", "state", " ", "matrix"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sM", "=", 
       RowBox[{"stateMatrix", "[", 
        RowBox[{"J", ",", "P", ",", "\[CapitalLambda]", ",", "\[Gamma]Max"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Obtain", " ", "observable", " ", "in", " ", "12", " ", "frame"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"observable12", "=", 
       RowBox[{"polynomialOperatorRho", "[", 
        RowBox[{"sM", ",", "power"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "transform", " ", "the", " ", "observable", " ", "in", " ", "to", " ", 
        "frame", " ", "23"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"observable23", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "t1", "]"}], ".", "observable12", ".", 
        "t1"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
       "transform", " ", "the", " ", "observable", " ", "in", " ", "to", " ", 
        "frame", " ", "31"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"observable31", "=", 
       RowBox[{
        RowBox[{"Transpose", "[", "t2", "]"}], ".", "observable12", ".", 
        "t2"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Collect", " ", "observables", " ", "into", " ", "a", " ", "list", " ",
         "that", " ", "we", " ", "can", " ", "iterate", " ", "over"}], " ", "*)"}
       ], 
      RowBox[{"observables", "=", 
       RowBox[{"{", 
        RowBox[{"observable12", ",", "observable23", ",", "observable31"}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"alphas", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Alpha]", "[", 
          RowBox[{"m1", ",", "m2", ",", "wMin"}], "]"}], ",", 
         RowBox[{"\[Alpha]1", "[", 
          RowBox[{"m1", ",", "m2", ",", "m3", ",", "wMin"}], "]"}], ",", 
         RowBox[{"\[Alpha]2", "[", 
          RowBox[{"m1", ",", "m2", ",", "m3", ",", "wMin"}], "]"}]}], "}"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eVec", "[", "omega_", "]"}], ":=", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{"evec", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Eigenvectors", "[", 
            RowBox[{"Hb", "[", 
             RowBox[{
             "J", ",", "P", ",", "Isospin", ",", "\[CapitalLambda]", ",", 
              "\[Gamma]Max", ",", "omega", ",", "m1", ",", "m2", ",", "m3", 
              ",", "project"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "firstNonZero"}], "]"}], "]"}], "//", "Chop"}]}], 
        ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"expVals", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"alphas", "[", 
            RowBox[{"[", "alpha", "]"}], "]"}], "^", "3"}], "*", 
          RowBox[{
           RowBox[{"eVec", "[", "wMin", "]"}], ".", 
           RowBox[{"observables", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ".", 
           RowBox[{"eVec", "[", "wMin", "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Expectation Values pair {12, 23, 31}: \>\"", ",", "expVals"}], 
       "]"}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Expectation Values as ratios: \>\"", ",", 
        RowBox[{"expVals", "/", 
         RowBox[{"expVals", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.855061666223476*^9, 3.855061771774568*^9}, {
  3.8550618113128157`*^9, 3.855061868527515*^9}, {3.855061949041774*^9, 
  3.855062024943923*^9}, {3.855209988723116*^9, 
  3.855210036104344*^9}},ExpressionUUID->"e5e7a59b-dd7e-4bc5-87f1-\
83f07eb6e201"]
},
WindowSize->{927, 1016},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4631, 109, 561, "Input",ExpressionUUID->"e5e7a59b-dd7e-4bc5-87f1-83f07eb6e201"]
}
]
*)

