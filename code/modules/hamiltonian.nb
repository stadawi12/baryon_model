(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     18176,        447]
NotebookOptionsPosition[     17856,        433]
NotebookOutlinePosition[     18220,        449]
CellTagsIndexPosition[     18177,        446]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Hb", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hb", "[", 
   RowBox[{
   "J_", ",", "P_", ",", "Isospin_", ",", "\[CapitalLambda]_", ",", "S_", ",",
     "\[Gamma]Max_", ",", "\[Omega]_", ",", "m1_", ",", "m2_", ",", "m3_", 
    ",", "project_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Hb", "[", 
    RowBox[{
    "J", ",", "P", ",", "Isospin", ",", "\[CapitalLambda]", ",", "S", ",", 
     "\[Gamma]Max", ",", "\[Omega]", ",", "m1", ",", "m2", ",", "m3", ",", 
     "project"}], "]"}], "=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "projector", ",", "sM", ",", "vCoulomb", ",", "vLinear", ",", 
       "spinPart12", ",", "spinPart23", ",", "spinPart31", ",", "v12baryon", 
       ",", "v23baryon", ",", "v31baryon", ",", "kin", ",", "mTot", ",", 
       "cqqq", ",", "kinetic", ",", "Hbaryon"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "THIS", " ", "FUNCTION", " ", "RETURNS", " ", "THE", " ", "BARYON", " ",
        "HAMILTONIAN", " ", "MATRIX", " ", "FOR", " ", "A", " ", "GIVEN", " ",
        "\[Omega]"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"H", " ", "=", " ", 
       RowBox[{
        RowBox[{"T", " ", "+", " ", 
         RowBox[{"V", "\[IndentingNewLine]", "T"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"[", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"i", "=", "1"}], "3"], 
            SubscriptBox["m", "i"]}], "]"}], "+", 
          RowBox[{"\[Omega]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              SubscriptBox["n", "\[Rho]"]}], "+", 
             SubscriptBox["l", "\[Rho]"], "+", 
             RowBox[{"3", "/", "2"}]}], ")"}]}], "-", 
          RowBox[{
           FractionBox["1", "2"], 
           SubscriptBox["\[Mu]", "\[Rho]"], 
           SuperscriptBox["\[Omega]", "2"], 
           SuperscriptBox["\[Rho]", "2"]}], "+", 
          RowBox[{"\[Omega]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              SubscriptBox["n", "\[Lambda]"]}], "+", 
             SubscriptBox["l", "\[Lambda]"], "+", 
             RowBox[{"3", "/", "2"}]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           SubscriptBox["\[Mu]", "\[Lambda]"], 
           SuperscriptBox["\[Omega]", "2"], 
           SuperscriptBox["\[Lambda]", "2"], "\[IndentingNewLine]", "V"}]}], 
         " ", "=", " ", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"i", "<", "j"}], "3"], 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["\[Kappa]", 
              SubscriptBox["r", "ij"]]}], "+", 
            SubscriptBox["\[Lambda]r", "ij"], "-", 
            SubscriptBox["C", "qqq"], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"8", 
               RowBox[{"\[Kappa]", "'"}], "\[Pi]"}], 
              RowBox[{"3", 
               SubscriptBox["m", "i"], 
               SubscriptBox["m", "j"]}]], 
             FractionBox[
              RowBox[{"exp", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  SubsuperscriptBox["r", "ij", "2"]}], "/", 
                 SubsuperscriptBox["r", "0", "2"]}], ")"}]}], 
              RowBox[{
               SuperscriptBox["\[Pi]", 
                RowBox[{"3", "/", "2"}]], 
               SubsuperscriptBox["r", "0", "3"]}]], 
             RowBox[{
              SubscriptBox["S", "i"], ".", 
              SubscriptBox["S", "j"]}]}]}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Calculate", " ", "projector", " ", "that", " ", "removes", " ", 
        "unwanted", " ", "states"}], ",", " ", 
       RowBox[{
        RowBox[{"only", " ", "applied", " ", "when", " ", "project"}], 
        "\[Equal]", "True"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"projector", "=", 
       RowBox[{"Projector", "[", 
        RowBox[{
        "J", ",", "P", ",", "\[CapitalLambda]", ",", "S", ",", "\[Gamma]Max", 
         ",", "Isospin"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Generate", " ", "an", " ", "auxiliary", " ", "matrix", " ", "of", " ",
         "all", " ", "state", " ", "sandwiches"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"sM", "=", 
       RowBox[{"stateMatrix", "[", 
        RowBox[{
        "J", ",", "P", ",", "\[CapitalLambda]", ",", "S", ",", 
         "\[Gamma]Max"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Obtain", " ", "the", " ", "dimensionless", " ", "linear", " ", "and", 
        " ", "coulomb", " ", "terms", " ", "as", " ", "matrices", " ", 
        "using", " ", "the", " ", "stateMatrix"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"vCoulomb", "=", 
       RowBox[{"polynomialOperatorRho", "[", 
        RowBox[{"sM", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        SubscriptBox["V", "C"], " ", "dimensionless"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"vLinear", "=", 
       RowBox[{"polynomialOperatorRho", "[", 
        RowBox[{"sM", ",", "1"}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
        SubscriptBox["V", "L"], " ", "dimensionless"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Obtain", " ", "all", " ", "dimensionful", " ", "matrices", " ", "of",
          " ", "only", " ", "the", " ", "spin"}], "-", 
        RowBox[{
        "spin", " ", "terms", " ", "for", " ", "all", " ", "coordinate", " ", 
         "frames"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"spinPart12", "=", 
       RowBox[{
        RowBox[{"coeffSS", "[", 
         RowBox[{"m1", ",", "m2"}], "]"}], "*", 
        RowBox[{"GaussOperator", "[", 
         RowBox[{
         "sM", ",", "\[Omega]", ",", "3", ",", "m1", ",", "m2", ",", "m3", 
          ",", 
          RowBox[{"sigmaSqrd", "[", 
           RowBox[{"m1", ",", "m2"}], "]"}]}], "]"}]}]}], ";", 
      RowBox[{"(*", " ", 
       SubsuperscriptBox["V", "SS", "radial"], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"spinPart23", "=", 
       RowBox[{
        RowBox[{"coeffSS", "[", 
         RowBox[{"m2", ",", "m3"}], "]"}], "*", 
        RowBox[{
         RowBox[{"Transpose", "[", "t1", "]"}], ".", 
         RowBox[{"GaussOperator", "[", 
          RowBox[{
          "sM", ",", "\[Omega]", ",", "1", ",", "m1", ",", "m2", ",", "m3", 
           ",", 
           RowBox[{"sigmaSqrd", "[", 
            RowBox[{"m2", ",", "m3"}], "]"}]}], "]"}], ".", "t1"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"spinPart31", "=", 
       RowBox[{
        RowBox[{"coeffSS", "[", 
         RowBox[{"m3", ",", "m1"}], "]"}], "*", 
        RowBox[{
         RowBox[{"Transpose", "[", "t2", "]"}], ".", 
         RowBox[{"GaussOperator", "[", 
          RowBox[{
          "sM", ",", "\[Omega]", ",", "2", ",", "m1", ",", "m2", ",", "m3", 
           ",", 
           RowBox[{"sigmaSqrd", "[", 
            RowBox[{"m3", ",", "m1"}], "]"}]}], "]"}], ".", "t2"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Calculate", " ", "the", " ", "sum", " ", "of", " ", "the"}], 
        ",", " ", 
        RowBox[{"now", " ", "dimensionful"}], ",", " ", "linear", ",", " ", 
        RowBox[{"coulomb", " ", "and", " ", "spin", " ", 
         RowBox[{"terms", ":", " ", 
          RowBox[{
           SubscriptBox["V", "C"], "+", 
           SubscriptBox["V", "L"], "+", 
           SubscriptBox["V", "ss"]}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"v12baryon", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "coeffCoulomb"}], "*", 
         RowBox[{"\[Alpha]", "[", 
          RowBox[{"m1", ",", "m2", ",", "\[Omega]"}], "]"}], "*", 
         "vCoulomb"}], "+", 
        FractionBox[
         RowBox[{"coeffLinear", "*", "vLinear"}], 
         RowBox[{"\[Alpha]", "[", 
          RowBox[{"m1", ",", "m2", ",", "\[Omega]"}], "]"}]], "+", 
        "spinPart12"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v23baryon", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "coeffCoulomb"}], "*", 
         RowBox[{"\[Alpha]1", "[", 
          RowBox[{"m1", ",", "m2", ",", "m3", ",", "\[Omega]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "t1", "]"}], ".", "vCoulomb", ".", 
           "t1"}], ")"}]}], "+", 
        FractionBox[
         RowBox[{"coeffLinear", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Transpose", "[", "t1", "]"}], ".", "vLinear", ".", 
            "t1"}], ")"}]}], 
         RowBox[{"\[Alpha]1", "[", 
          RowBox[{"m1", ",", "m2", ",", "m3", ",", "\[Omega]"}], "]"}]], "+", 
        "spinPart23"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v31baryon", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "coeffCoulomb"}], "*", 
         RowBox[{"\[Alpha]2", "[", 
          RowBox[{"m1", ",", "m2", ",", "m3", ",", "\[Omega]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Transpose", "[", "t2", "]"}], ".", "vCoulomb", ".", 
           "t2"}], ")"}]}], "+", 
        FractionBox[
         RowBox[{"coeffLinear", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Transpose", "[", "t2", "]"}], ".", "vLinear", ".", 
            "t2"}], ")"}]}], 
         RowBox[{"\[Alpha]2", "[", 
          RowBox[{"m1", ",", "m2", ",", "m3", ",", "\[Omega]"}], "]"}]], "+", 
        "spinPart31"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Calculate", " ", "the", " ", "matrix", " ", "form", " ", "of", " ", 
        "the", " ", "kinetic", " ", "term"}], "  ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"kin", "=", 
       RowBox[{"kMatrix", "[", 
        RowBox[{"sM", ",", "\[Omega]", ",", "m1", ",", "m2", ",", "m3"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Generate", " ", "the", " ", 
        SubscriptBox["m", "i"], " ", "terms", " ", "in", " ", "the", " ", 
        "hamiltonian", " ", "as", " ", "matrices"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"mTot", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "size", "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"m1", "+", "m2", "+", "m3"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Generate", " ", "the", " ", 
        SubscriptBox["C", "qqq"], " ", "term", " ", "in", " ", "Hamiltonian", 
        " ", "as", " ", "a", " ", "matrix"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"cqqq", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "size", "]"}], "*", 
        RowBox[{"(", "Cqqq", ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Combine", " ", "the", " ", "mass", " ", "and", " ", "rest", " ", "of",
         " ", "kinetic", " ", "term", " ", "into", " ", "one", " ", "term"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"kinetic", "=", 
       RowBox[{"mTot", "+", "kin"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Combine", " ", "all", " ", "terms"}], ",", " ", 
        RowBox[{
         RowBox[{
         "kinetic", " ", "and", " ", "potential", " ", "terms", " ", "to", 
          " ", "obtain", " ", "the", " ", "total", " ", "H", 
          "\[IndentingNewLine]", "Multiply", " ", "potential", " ", "by", " ",
           "Colour", " ", "Factor"}], " ", "-", " ", 
         RowBox[{"see", " ", 
          RowBox[{"Silvestre", "'"}], "s", " ", "paper"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Hbaryon", "=", 
       RowBox[{"kinetic", "+", 
        RowBox[{"CF", 
         RowBox[{"(", 
          RowBox[{"v12baryon", "+", "v23baryon", "+", "v31baryon", "-", 
           RowBox[{"3", "*", "cqqq"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Hbaryon", "=", 
       RowBox[{"Hbaryon", "-", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "sM", "]"}], "]"}], "*", 
         FractionBox[
          RowBox[{"2.02", "*", 
           SuperscriptBox["10", 
            RowBox[{"-", "3"}]]}], 
          RowBox[{"m1", "*", "m2", "*", "m3"}]]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Apply", " ", "projector", " ", "if", " ", "project"}], 
        "\[Equal]", 
        RowBox[{
        "True", " ", "and", " ", "remove", " ", "rows", " ", "and", " ", 
         "columns", " ", "which", " ", "are", " ", "zeros"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"project", ",", 
        RowBox[{
         RowBox[{"Hbaryon", "=", 
          RowBox[{"ApplyProjector", "[", 
           RowBox[{"Hbaryon", ",", "projector"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"zeros", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"row", "=", "1"}], ",", 
           RowBox[{"row", "\[LessEqual]", 
            RowBox[{"Length", "[", "Hbaryon", "]"}]}], ",", 
           RowBox[{"row", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"r", "=", 
             RowBox[{"Hbaryon", "[", 
              RowBox[{"[", "row", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            
            RowBox[{"c", "=", 
             RowBox[{"Hbaryon", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "row"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Total", "[", "r", "]"}], "\[Equal]", "0"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"zeros", ",", 
                RowBox[{"{", "row", "}"}]}], "]"}]}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Hbaryon", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"Hbaryon", ",", "zeros"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"removeList", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"zeros", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"Length", "[", "zeros", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "Hbaryon", "]"}]}], "}"}]}], "]"}], 
            ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Hbaryon", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"Hbaryon", ",", "removeList"}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Finally", ",", " ", 
        RowBox[{
         RowBox[{"subtract", " ", "the", " ", "three"}], "-", 
         RowBox[{"body", " ", "contribution"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "Hbaryon", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<modules/dumpSave/hamiltonian.mx\>\"", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.852375607016711*^9, 3.852375632857542*^9}, {
   3.85237570546586*^9, 3.8523757503043013`*^9}, {3.8523757870175257`*^9, 
   3.8523757944283037`*^9}, {3.852384371477243*^9, 3.852384376588442*^9}, {
   3.853314759661025*^9, 3.853314799711234*^9}, {3.855211904527978*^9, 
   3.8552119045868187`*^9}, 3.855212193053739*^9, {3.855212695608996*^9, 
   3.8552127031498013`*^9}, 3.855725817416087*^9, {3.855734282563024*^9, 
   3.855734294623612*^9}, {3.8557345308717813`*^9, 3.855734542490953*^9}, {
   3.855734632771023*^9, 3.8557346414120626`*^9}, {3.855734948140349*^9, 
   3.855734954296399*^9}, {3.8557350553954973`*^9, 3.855735059713451*^9}, {
   3.855735461127137*^9, 3.855735502967235*^9}, 3.8557357167381287`*^9, 
   3.855735838637127*^9, {3.8566075958502617`*^9, 3.856607624719781*^9}, {
   3.858077416386285*^9, 3.8580776551168528`*^9}, {3.858161647314391*^9, 
   3.8581616681633453`*^9}, {3.858317271384447*^9, 3.858317346319175*^9}, {
   3.858317484012496*^9, 3.858317502141095*^9}, {3.858318972568215*^9, 
   3.8583189946688967`*^9}, {3.858754590297682*^9, 
   3.858754602470346*^9}},ExpressionUUID->"0a487b3b-0477-4dda-8a4a-\
1bba9fdae37b"]
},
WindowSize->{1854, 1016},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.2 Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 17294, 411, 1756, "Input",ExpressionUUID->"0a487b3b-0477-4dda-8a4a-1bba9fdae37b"]
}
]
*)

