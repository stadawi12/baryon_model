(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26168,        685]
NotebookOptionsPosition[     25878,        672]
NotebookOutlinePosition[     26212,        687]
CellTagsIndexPosition[     26169,        684]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Rcoeff", ",", "Lcoeff", ",", "ksum", ",", "rPsum", ",", "rel"}], 
  "]"}], "\n", 
 RowBox[{
  RowBox[{"Rcoeff", "[", 
   RowBox[{"n_", ",", "l_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Rcoeff", "[", 
    RowBox[{"n", ",", "l"}], "]"}], "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "*", 
       RowBox[{"n", "!"}]}], ")"}], "/", 
     RowBox[{"Gamma", "[", 
      RowBox[{"n", "+", "l", "+", 
       RowBox[{"3", "/", "2"}]}], "]"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"Lcoeff", "[", 
   RowBox[{"n_", ",", "l_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Lcoeff", "[", 
    RowBox[{"n", ",", "l", ",", "k"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", "k"}], "*", 
      RowBox[{"Gamma", "[", 
       RowBox[{"n", "+", "l", "+", 
        RowBox[{"3", "/", "2"}]}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "k"}], ")"}], "!"}], "*", 
      RowBox[{"Gamma", "[", 
       RowBox[{"k", "+", "l", "+", 
        RowBox[{"3", "/", "2"}]}], "]"}], "*", 
      RowBox[{"k", "!"}]}], ")"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"ksum", "[", 
   RowBox[{"n_", ",", "m_", ",", "l_", ",", "p_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ksum", "[", 
    RowBox[{"n", ",", "m", ",", "l", ",", "p"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Lcoeff", "[", 
       RowBox[{"n", ",", "l", ",", "k"}], "]"}], "*", 
      RowBox[{"Lcoeff", "[", 
       RowBox[{"m", ",", "l", ",", 
        RowBox[{"p", "-", "k", "-", "l"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Max", "[", 
        RowBox[{"0", ",", 
         RowBox[{"p", "-", "l", "-", "m"}]}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"n", ",", 
         RowBox[{"p", "-", "l"}]}], "]"}]}], "}"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"rPsum", "[", 
   RowBox[{"n_", ",", "m_", ",", "l_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"rPsum", "[", 
    RowBox[{"n", ",", "m", ",", "l", ",", "y"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"p", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], "*", "y"}], "+", 
        RowBox[{"3", "/", "2"}]}], "]"}], "*", 
      RowBox[{"ksum", "[", 
       RowBox[{"n", ",", "m", ",", "l", ",", "p"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"p", ",", "l", ",", 
       RowBox[{"l", "+", "n", "+", "m"}]}], "}"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rel", "[", 
    RowBox[{"n_", ",", "m_", ",", "l_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"rel", "[", 
     RowBox[{"n", ",", "m", ",", "l", ",", "y"}], "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], "*", 
     RowBox[{"Rcoeff", "[", 
      RowBox[{"n", ",", "l"}], "]"}], "*", 
     RowBox[{"Rcoeff", "[", 
      RowBox[{"m", ",", "l"}], "]"}], "*", 
     RowBox[{"rPsum", "[", 
      RowBox[{"n", ",", "m", ",", "l", ",", "y"}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"CREATES", " ", "THE", " ", "KINETIC", " ", "MATRIX"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kMatrix", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]Max_", ",", "omega_"}], "]"}], 
   ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Omega]", "=", "omega"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sM", "=", 
      RowBox[{"stateMatrix", "[", 
       RowBox[{"\[CapitalLambda]", ",", "\[Gamma]Max"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "sM", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "sM", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"np", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "1"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"lp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "2"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"l", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "2"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"nlp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "3"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"llp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "4"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"nl", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "3"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"ll", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "4"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"qhoRho", "=", 
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"np", ",", "n"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"lp", ",", "l"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"llp", ",", "ll"}], "]"}], "*", "omega", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "np"}], "+", "lp", "+", 
              RowBox[{"3", "/", "2"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"qhoLam", "=", 
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"np", ",", "n"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"lp", ",", "l"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"llp", ",", "ll"}], "]"}], "*", "omega", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "nl"}], "+", "ll", "+", 
              RowBox[{"3", "/", "2"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rhoSqrd", "=", 
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"lp", ",", "l"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"llp", ",", "ll"}], "]"}], "*", 
            RowBox[{"1", "/", "2"}], " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Mu]\[Rho]", "*", 
               RowBox[{
                RowBox[{"(", "omega", ")"}], "^", "2"}]}], ")"}], "/", 
             RowBox[{"\[Alpha]", "^", "2"}]}], " ", 
            RowBox[{"rel", "[", 
             RowBox[{"np", ",", "n", ",", "l", ",", "2"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"lamSqrd", "=", 
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"np", ",", "n"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"lp", ",", "l"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"llp", ",", "ll"}], "]"}], "*", 
            RowBox[{"1", "/", "2"}], " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Mu]\[Lambda]", "*", 
               RowBox[{
                RowBox[{"(", "omega", ")"}], "^", "2"}]}], ")"}], "/", 
             RowBox[{"\[Beta]", "^", "2"}]}], " ", 
            RowBox[{"rel", "[", 
             RowBox[{"nlp", ",", "nl", ",", "ll", ",", "2"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"new", ",", 
            RowBox[{
            "qhoRho", "+", "qhoLam", "-", "rhoSqrd", "-", "lamSqrd"}]}], 
           "]"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"new", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "sM", "]"}], ",", 
          RowBox[{"Length", "[", "sM", "]"}]}], "}"}]}], "]"}]}]}], ")"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"polynomialOperatorRho", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]Max_", ",", "power_"}], "]"}], 
   ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sM", "=", 
      RowBox[{"stateMatrix", "[", 
       RowBox[{"\[CapitalLambda]", ",", "\[Gamma]Max"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "sM", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "sM", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"np", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "1"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"lp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "2"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"l", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "2"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"nlp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "3"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"llp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "4"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"nl", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "3"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"ll", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "4"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"rho", "=", 
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"lp", ",", "l"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"llp", ",", "ll"}], "]"}], "*", 
            RowBox[{"rel", "[", 
             RowBox[{"np", ",", "n", ",", "l", ",", "power"}], "]"}]}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"new", ",", "rho"}], "]"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"new", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "sM", "]"}], ",", 
          RowBox[{"Length", "[", "sM", "]"}]}], "}"}]}], "]"}]}]}], ")"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"polynomialOperatorLambda", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]Max_", ",", "power_"}], "]"}], 
   ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sM", "=", 
      RowBox[{"stateMatrix", "[", 
       RowBox[{"\[CapitalLambda]", ",", "\[Gamma]Max"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "sM", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "sM", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"np", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "1"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"lp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "2"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"l", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "2"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"nlp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "3"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"llp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "4"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"nl", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "3"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"ll", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "4"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"lambda", "=", 
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"np", ",", "n"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"lp", ",", "l"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"llp", ",", "ll"}], "]"}], "*", 
            RowBox[{"rel", "[", 
             RowBox[{"nlp", ",", "nl", ",", "ll", ",", "power"}], "]"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"new", ",", "lambda"}], "]"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"new", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "sM", "]"}], ",", 
          RowBox[{"Length", "[", "sM", "]"}]}], "}"}]}], "]"}]}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vExact", "[", 
    RowBox[{
    "\[CapitalLambda]_", ",", "\[Gamma]Max_", ",", "coeffRho_", ",", 
     "coeffLam_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sM", "=", 
      RowBox[{"stateMatrix", "[", 
       RowBox[{"\[CapitalLambda]", ",", "\[Gamma]Max"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"new0", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "sM", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "sM", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"np", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "1"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"lp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "2"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"l", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "2"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"nlp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "3"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"llp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "4"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"nl", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "3"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"ll", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "4"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"rho", "=", 
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"lp", ",", "l"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"llp", ",", "ll"}], "]"}], "*", 
            RowBox[{"rel", "[", 
             RowBox[{"np", ",", "n", ",", "l", ",", "2"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"lam", "=", 
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"lp", ",", "l"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"np", ",", "n"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"llp", ",", "ll"}], "]"}], "*", 
            RowBox[{"rel", "[", 
             RowBox[{"nlp", ",", "nl", ",", "ll", ",", "2"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"new0", ",", 
            RowBox[{
             RowBox[{"coeffRho", "*", "rho"}], "+", 
             RowBox[{"coeffLam", "*", "lam"}]}]}], "]"}]}]}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"new0", "=", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"new0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "sM", "]"}], ",", 
          RowBox[{"Length", "[", "sM", "]"}]}], "}"}]}], "]"}]}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"delta3", "[", 
    RowBox[{"nPrime_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", "Pi"}]], "*", 
     RowBox[{"Rcoeff", "[", 
      RowBox[{"nPrime", ",", "0"}], "]"}], "*", 
     RowBox[{"Rcoeff", "[", 
      RowBox[{"n", ",", "0"}], "]"}], "*", 
     RowBox[{"LaguerreL", "[", 
      RowBox[{"nPrime", ",", 
       FractionBox["1", "2"], ",", "0"}], "]"}], "*", 
     RowBox[{"LaguerreL", "[", 
      RowBox[{"n", ",", 
       FractionBox["1", "2"], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
    ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delta3RhoMatrix", "[", 
   RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]Max_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sM", "=", 
     RowBox[{"stateMatrix", "[", 
      RowBox[{"\[CapitalLambda]", ",", "\[Gamma]Max"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"new", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "sM", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "sM", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"np", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"l", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nlp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"llp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nl", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ll", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"l", "\[Equal]", "0"}], ",", 
           RowBox[{"del", "=", 
            RowBox[{
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{"lp", ",", "l"}], "]"}], "*", 
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
             RowBox[{"KroneckerDelta", "[", 
              RowBox[{"llp", ",", "ll"}], "]"}], "*", 
             RowBox[{"delta3", "[", 
              RowBox[{"np", ",", "n"}], "]"}]}]}], ",", 
           RowBox[{"del", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"new", ",", "del"}], "]"}]}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"new", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"new", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "sM", "]"}], ",", 
         RowBox[{"Length", "[", "sM", "]"}]}], "}"}]}], "]"}]}]}], 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.814509936468462*^9, 3.8145099539927073`*^9}, {
  3.8145116440580883`*^9, 3.8145116592728033`*^9}, {3.814511773968891*^9, 
  3.814511795959752*^9}, {3.81451187289679*^9, 3.814511881317325*^9}, {
  3.814512081154612*^9, 3.814512119123254*^9}, {3.8145121799003477`*^9, 
  3.8145122007000103`*^9}, {3.814512334546776*^9, 3.814512433873641*^9}, {
  3.8157507154034367`*^9, 3.815750746473138*^9}, {3.815750902284931*^9, 
  3.815750907286749*^9}, {3.815750968749872*^9, 3.815750998000532*^9}, {
  3.815751052943893*^9, 3.8157511264496117`*^9}, {3.815751997664381*^9, 
  3.815752057873145*^9}, {3.8157521052940607`*^9, 3.815752127611396*^9}, {
  3.815752513603774*^9, 3.8157525894177303`*^9}, {3.815752621410281*^9, 
  3.815752652244234*^9}, {3.815754400746663*^9, 3.815754406448606*^9}, {
  3.8158070786328897`*^9, 
  3.8158071044309807`*^9}},ExpressionUUID->"77518bdd-a50c-46eb-a572-\
a991744c92b5"]
},
WindowSize->{1846, 1016},
WindowMargins->{{0, Automatic}, {0, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 25316, 650, 2263, "Input",ExpressionUUID->"77518bdd-a50c-46eb-a572-a991744c92b5"]
}
]
*)

