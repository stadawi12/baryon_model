(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     55454,       1332]
NotebookOptionsPosition[     54694,       1312]
NotebookOutlinePosition[     55105,       1330]
CellTagsIndexPosition[     55062,       1327]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "theta", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"theta", "[", "i_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "\[Equal]", "1"}], ",", 
       RowBox[{"tan", "=", 
        RowBox[{"-", 
         SqrtBox[
          FractionBox[
           RowBox[{"m2", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2", "+", "m3"}], ")"}]}], 
           RowBox[{"m1", " ", "m3"}]]]}]}], ",", 
       RowBox[{"tan", "=", 
        SqrtBox[
         FractionBox[
          RowBox[{"m1", 
           RowBox[{"(", 
            RowBox[{"m1", "+", "m2", "+", "m3"}], ")"}]}], 
          RowBox[{"m2", " ", "m3"}]]]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"ArcTan", "[", "tan", "]"}], "+", "Pi"}], "]"}]}], 
    "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Nine", "-", 
    RowBox[{"J", " ", "function"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nineJ", "[", 
    RowBox[{
    "j1_", ",", "j2_", ",", "j4_", ",", "j5_", ",", "x_", ",", "L_", ",", 
     "l_", ",", "\[CapitalLambda]_", ",", "l1_", ",", "l2_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{"2", "*", "x"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "x"}], "+", "1"}], ")"}], "*", 
    RowBox[{"SixJSymbol", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j1", ",", "j4", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "\[CapitalLambda]", ",", "x"}], "}"}]}], "]"}], "*", 
    RowBox[{"SixJSymbol", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j2", ",", "j5", ",", "l"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j4", ",", "x", ",", "l2"}], "}"}]}], "]"}], "*", 
    RowBox[{"SixJSymbol", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l1", ",", "l2", ",", "\[CapitalLambda]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "j1", ",", "j2"}], "}"}]}], "]"}]}]}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Talmi", " ", "coefficient", " ", "function"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"talmi", "[", 
    RowBox[{
    "n1_", ",", "l1_", ",", "n2_", ",", "l2_", ",", "n_", ",", "l_", ",", 
     "nN_", ",", "L_", ",", "\[CapitalLambda]_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"F", "-", "Matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fMatrix", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "2", ",", "1", ",", "0", ",", "0", ",", "0", ",",
           "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "2", ",", "1", ",", "0", ",",
           "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "2", ",",
           "1"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"list", " ", "of", " ", "Fs"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ListOfFs", " ", "=", " ", 
      RowBox[{"fMatrix", ".", 
       RowBox[{"{", 
        RowBox[{
        "n1", ",", "l1", ",", "n2", ",", "l2", ",", "nN", ",", "L", ",", "n", 
         ",", "l"}], "}"}]}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{"{", " ", 
       RowBox[{
        SubscriptBox["f", "1"], " ", ",", " ", 
        SubscriptBox["f", "2"], " ", ",", " ", "F", " ", ",", " ", "f"}], " ",
        "}"}], " ", "*)"}], "\n", 
     RowBox[{"(*", " ", "aMatrix", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"aMatrix", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "2", ",", "2", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",",
           "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "2", ",", "2", ",", "0", ",", "0", ",", "1", ",",
           "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "2", ",", "0", ",", "2", ",", "0", ",", "1", ",", "0", ",", "1", ",",
           "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "2", ",", "0", ",", "2", ",", "0", ",", "1", ",", "0", ",",
           "1"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"determine", " ", "amin"}], ",", " ", "bmin", ",", " ", 
       RowBox[{"cmin", " ", "and", " ", "dmin"}]}], " ", "*)"}], "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "<", 
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", 
       RowBox[{"amin", "=", 
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"amin", "=", 
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "<", 
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ",", 
       RowBox[{"bmin", "=", 
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"bmin", "=", 
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "<", 
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", 
       RowBox[{"cmin", "=", 
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"cmin", "=", 
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "<", 
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ",", 
       RowBox[{"dmin", "=", 
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"dmin", "=", 
        RowBox[{"ListOfFs", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Obtain", " ", "summation", " ", "variables", " ", 
       RowBox[{"{", 
        RowBox[{"(", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "la", ",", "lb", ",", "lc", 
          ",", "ld"}], ")"}], "}"}]}], " ", "*)"}], "\n", 
     RowBox[{"SummationVariables", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"a", "=", "0"}], ",", 
       RowBox[{"a", "<", 
        RowBox[{
         RowBox[{"Floor", "[", 
          RowBox[{"amin", "/", "2"}], "]"}], "+", "1"}]}], ",", 
       RowBox[{"a", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"b", "=", "0"}], ",", 
         RowBox[{"b", "<", 
          RowBox[{
           RowBox[{"Floor", "[", 
            RowBox[{"bmin", "/", "2"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"b", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"c", "=", "0"}], ",", 
           RowBox[{"c", "<", 
            RowBox[{
             RowBox[{"Floor", "[", 
              RowBox[{"cmin", "/", "2"}], "]"}], "+", "1"}]}], ",", 
           RowBox[{"c", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"d", "=", "0"}], ",", 
             RowBox[{"d", "<", 
              RowBox[{
               RowBox[{"Floor", "[", 
                RowBox[{"dmin", "/", "2"}], "]"}], "+", "1"}]}], ",", 
             RowBox[{"d", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"la", "=", "0"}], ",", 
               RowBox[{"la", "<", 
                RowBox[{"amin", "+", "1"}]}], ",", 
               RowBox[{"la", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"lb", "=", "0"}], ",", 
                 RowBox[{"lb", "<", 
                  RowBox[{"bmin", "+", "1"}]}], ",", 
                 RowBox[{"lb", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"lc", "=", "0"}], ",", 
                   RowBox[{"lc", "<", 
                    RowBox[{"cmin", "+", "1"}]}], ",", 
                   RowBox[{"lc", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ld", "=", "0"}], ",", 
                    RowBox[{"ld", "<", 
                    RowBox[{"dmin", "+", "1"}]}], ",", 
                    RowBox[{"ld", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"aMatrix", ".", 
                    RowBox[{"{", 
                    RowBox[{
                    "a", ",", "b", ",", "c", ",", "d", ",", "la", ",", "lb", 
                    ",", "lc", ",", "ld"}], "}"}]}], "\[Equal]", "ListOfFs"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"la", "-", "lc"}], "]"}], ",", 
                    RowBox[{"la", "+", "lc"}]}], "]"}], ",", "L"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"lb", "-", "ld"}], "]"}], ",", 
                    RowBox[{"lb", "+", "ld"}]}], "]"}], ",", "l"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"la", "-", "lb"}], "]"}], ",", 
                    RowBox[{"la", "+", "lb"}]}], "]"}], ",", "l1"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"lc", "-", "ld"}], "]"}], ",", 
                    RowBox[{"lc", "+", "ld"}]}], "]"}], ",", "l2"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", 
                    RowBox[{"la", "+", "lc", "+", "L"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", 
                    RowBox[{"lb", "+", "ld", "+", "l"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", 
                    RowBox[{"la", "+", "lb", "+", "l1"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"EvenQ", "[", 
                    RowBox[{"lc", "+", "ld", "+", "l2"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"SummationVariables", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "a", ",", "b", ",", "c", ",", "d", ",", "la", ",", "lb", 
                    ",", "lc", ",", "ld"}], "}"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
            "]"}]}], "]"}]}], "]"}]}], "]"}], ";", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
      "bin", " ", "for", " ", "collecting", " ", "sum", " ", "terms"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sum", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"some", " ", "coefficient"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"coeff", " ", "=", " ", 
      RowBox[{
       SuperscriptBox["\[ImaginaryI]", 
        RowBox[{"(", 
         RowBox[{"l1", "+", "l2", "+", "L", "+", "l"}], ")"}]], "*", 
       SuperscriptBox["2", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"l1", "+", "l2", "+", "L", "+", "l"}], ")"}]}], "/", 
         "4"}]], "*", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n1", "!"}], 
          RowBox[{"n2", "!"}], 
          RowBox[{"nN", "!"}], 
          RowBox[{"n", "!"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"n1", "+", "l1"}], ")"}]}], "+", "1"}], ")"}], "!!"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"n2", "+", "l2"}], ")"}]}], "+", "1"}], ")"}], "!!"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"nN", "+", "L"}], ")"}]}], "+", "1"}], ")"}], "!!"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"n", "+", "l"}], ")"}]}], "+", "1"}], ")"}], "!!"}]}], 
         ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "calculate", " ", "sum", " ", "terms", " ", "and", " ", "append", " ", 
       "them", " ", "to", " ", "bin", " ", 
       RowBox[{"(", "sum", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{
         RowBox[{"Length", "[", "SummationVariables", "]"}], "+", "1"}]}], 
       ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "declare", " ", "variables", " ", "inside", " ", "For", " ", "loop"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"J", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SummationVariables", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "5"}], "]"}], "]"}], ",", 
           RowBox[{"SummationVariables", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "6"}], "]"}], "]"}], ",", "l1", ",", 
           RowBox[{"SummationVariables", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "7"}], "]"}], "]"}], ",", 
           RowBox[{"SummationVariables", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "8"}], "]"}], "]"}], ",", "l2", ",", "L", ",", 
           "l", ",", "\[CapitalLambda]"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"SummationVariables", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"SummationVariables", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"SummationVariables", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"SummationVariables", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"la", "=", 
         RowBox[{"J", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lb", "=", 
         RowBox[{"J", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lc", "=", 
         RowBox[{"J", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ld", "=", 
         RowBox[{"J", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"y", "=", " ", 
         RowBox[{"Intersection", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"la", "-", "\[CapitalLambda]"}], "]"}], ",", 
             RowBox[{"la", "+", "\[CapitalLambda]"}]}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"l", "-", "lc"}], "]"}], ",", 
             RowBox[{"l", "+", "lc"}]}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"lb", "-", "l2"}], "]"}], ",", 
             RowBox[{"lb", "+", "l2"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Append", " ", "the", " ", "crazy", " ", "formula", " ", "into", " ",
           "sum"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"sum", ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"la", "+", "lb", "+", "lc"}]], "*", 
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"la", "+", "lb", "+", "lc", "+", "ld"}], ")"}], "/", 
             "2"}]], "*", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Sin", "[", 
              RowBox[{"theta", "[", "\[Theta]", "]"}], "]"}], ")"}], 
            RowBox[{
             RowBox[{"2", "a"}], "+", "la", "+", 
             RowBox[{"2", "d"}], "+", "ld"}]], "*", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Cos", "[", 
              RowBox[{"theta", "[", "\[Theta]", "]"}], "]"}], ")"}], 
            RowBox[{
             RowBox[{"2", "b"}], "+", "lb", "+", 
             RowBox[{"2", "c"}], "+", "lc"}]], "*", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"nineJ", "[", 
              RowBox[{"la", ",", "lb", ",", "lc", ",", "ld", ",", 
               RowBox[{"y", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "L", ",", "l", ",", 
               "\[CapitalLambda]", ",", "l1", ",", "l2"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "y", "]"}]}], "}"}]}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "la"}], "+", "1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "lb"}], "+", "1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "lc"}], "+", "1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "ld"}], "+", "1"}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "!"}], 
               RowBox[{"b", "!"}], 
               RowBox[{"c", "!"}], 
               RowBox[{"d", "!"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", 
                   RowBox[{"(", 
                    RowBox[{"a", "+", "la"}], ")"}]}], "+", "1"}], ")"}], 
                "!!"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", 
                   RowBox[{"(", 
                    RowBox[{"b", "+", "lb"}], ")"}]}], "+", "1"}], ")"}], 
                "!!"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", 
                   RowBox[{"(", 
                    RowBox[{"c", "+", "lc"}], ")"}]}], "+", "1"}], ")"}], 
                "!!"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", 
                   RowBox[{"(", 
                    RowBox[{"d", "+", "ld"}], ")"}]}], "+", "1"}], ")"}], 
                "!!"}]}], ")"}]}], ")"}], "*", 
           RowBox[{"ClebschGordan", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"la", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"lc", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"L", ",", "0"}], "}"}]}], "]"}], "*", 
           RowBox[{"ClebschGordan", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"lb", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ld", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "0"}], "}"}]}], "]"}], "*", 
           RowBox[{"ClebschGordan", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"la", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"lb", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"l1", ",", "0"}], "}"}]}], "]"}], "*", 
           RowBox[{"ClebschGordan", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"lc", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ld", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"l2", ",", "0"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "finally", " ", "output", " ", "the", " ", "result", " ", "which", " ", 
       "is", " ", "the", " ", "coefficient", " ", "times", " ", "the", " ", 
       "sum", " ", "constituents", " ", "all", " ", "added", " ", "up"}], " ",
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"l", "+", "L", "-", "\[CapitalLambda]"}]], "*", 
       RowBox[{"Total", "[", "sum", "]"}], "*", "coeff"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "t", "]"}]}], "\[IndentingNewLine]", ")"}]}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"OBTAINS", " ", "THE", " ", "SUMMATION", " ", "ARGUMENTS", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"COMBINATIONS", " ", "OF"}], " ", "|", "n"}], ",", "l", ",", 
      "N", ",", 
      RowBox[{"L", ":", 
       RowBox[{"\[CapitalLambda]", ">", " ", 
        RowBox[{"IN", " ", "THAT", " ", "ORDER"}]}]}]}], ")"}], " ", "THAT", 
    " ", "ARE", " ", "ALLOWED", " ", "FOR", " ", "A", " ", "SPECIFIED", " ", 
    "ENERGY", " ", "\[Gamma]", " ", "AND", " ", 
    RowBox[{"T", ".", "O", ".", "A", ".", "M", ".", " ", "L"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sumArgs", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nlist", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"llist", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"n", "=", "0"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "n"}], "\[LessEqual]", "\[Gamma]"}], ",", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"nlist", ",", "n"}], "]"}], ";", 
        RowBox[{"n", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"l", "=", "0"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"l", "\[LessEqual]", "\[Gamma]"}], ",", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"llist", ",", "l"}], "]"}], ";", 
        RowBox[{"l", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"sArgs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "nlist", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "llist", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "[", "nlist", "]"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"m", "=", "1"}], ",", 
             RowBox[{"m", "\[LessEqual]", 
              RowBox[{"Length", "[", "llist", "]"}]}], ",", 
             RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"2", 
                  RowBox[{"nlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                 RowBox[{"llist", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "+", 
                 RowBox[{"2", 
                  RowBox[{"nlist", "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}], "+", 
                 RowBox[{"llist", "[", 
                  RowBox[{"[", "m", "]"}], "]"}]}], "\[Equal]", "\[Gamma]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{"lvals", ",", 
                    RowBox[{"{", 
                    RowBox[{"lvals", ",", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"llist", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                    RowBox[{"llist", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"llist", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", 
                    RowBox[{"llist", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
                   "\[CapitalLambda]"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"sArgs", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"llist", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"nlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"llist", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "}"}]}], "]"}]}], 
                "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "sArgs", "]"}]}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "OBTAINS", " ", "COEFFICIENTS", " ", "OF", " ", "ALL", " ", "STATES"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"talmiCoeffs", "[", 
   RowBox[{
   "n1_", ",", "l1_", ",", "n2_", ",", "l2_", ",", "\[CapitalLambda]_", ",", 
    "\[Theta]_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"coeffs", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Gamma]", "=", 
     RowBox[{
      RowBox[{"2", "n1"}], "+", "l1", "+", 
      RowBox[{"2", "n2"}], "+", "l2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"args", " ", "=", " ", 
     RowBox[{"sumArgs", "[", 
      RowBox[{"\[CapitalLambda]", ",", "\[Gamma]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"wuba", "=", "1"}], ",", 
      RowBox[{"wuba", "<", 
       RowBox[{
        RowBox[{"Length", "[", "args", "]"}], "+", "1"}]}], ",", 
      RowBox[{"wuba", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nN", "=", 
        RowBox[{"args", "[", 
         RowBox[{"[", 
          RowBox[{"wuba", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lL", "=", 
        RowBox[{"args", "[", 
         RowBox[{"[", 
          RowBox[{"wuba", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nn", "=", 
        RowBox[{"args", "[", 
         RowBox[{"[", 
          RowBox[{"wuba", ",", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ll", "=", 
        RowBox[{"args", "[", 
         RowBox[{"[", 
          RowBox[{"wuba", ",", "4"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coeff2", "=", 
        RowBox[{"talmi", "[", 
         RowBox[{
         "n1", ",", "l1", ",", "n2", ",", "l2", ",", "nN", ",", "lL", ",", 
          "nn", ",", "ll", ",", "\[CapitalLambda]", ",", "\[Theta]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"coeff2", "\[NotEqual]", "0"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"coeffs", ",", 
           RowBox[{"{", 
            RowBox[{"coeff2", ",", 
             RowBox[{"args", "[", 
              RowBox[{"[", "wuba", "]"}], "]"}]}], "}"}]}], "]"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", "coeffs", "]"}]}], "\[IndentingNewLine]", 
   ")"}]}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.7973409464893064`*^9, 3.7973410215761952`*^9}, 
   3.7973412874216933`*^9, 3.797858394218408*^9, {3.7978585816170497`*^9, 
   3.7978585837858067`*^9}, {3.797859299901308*^9, 3.797859313978243*^9}, {
   3.798284688048213*^9, 3.798284689536126*^9}, 3.798805979774327*^9, 
   3.7988697732381697`*^9, {3.7990457013149114`*^9, 3.7990457075423875`*^9}, {
   3.799045798194601*^9, 3.799045818736989*^9}, {3.799047062505337*^9, 
   3.7990470639944863`*^9}, {3.7991355167449884`*^9, 
   3.7991355192295694`*^9}, {3.7991359984669547`*^9, 3.799136030329765*^9}, {
   3.7991360614709854`*^9, 3.799136071045517*^9}, {3.799136658899909*^9, 
   3.799136679410199*^9}, {3.799136806114609*^9, 3.7991368639705772`*^9}, {
   3.799138249913293*^9, 3.7991383052097225`*^9}, {3.7991499898180237`*^9, 
   3.7991500031649666`*^9}, {3.799150115401384*^9, 3.799150120393416*^9}, {
   3.7991505435975204`*^9, 3.799150624862956*^9}, {3.7991507318338423`*^9, 
   3.799150753974765*^9}, {3.799407685248108*^9, 3.7994077163253655`*^9}, 
   3.8001004590422773`*^9, {3.8001005187741623`*^9, 3.800100519486755*^9}, {
   3.8001051767556763`*^9, 3.800105178801509*^9}, {3.800105403253302*^9, 
   3.800105426449066*^9}, {3.800105514092059*^9, 3.8001055241652927`*^9}, {
   3.80010555736134*^9, 3.8001055633519354`*^9}, {3.8001717536651163`*^9, 
   3.800171762176258*^9}, {3.8001727538843937`*^9, 3.800172761911813*^9}, {
   3.800174071460024*^9, 3.8001740965916357`*^9}, {3.8001839661082487`*^9, 
   3.8001839861718054`*^9}, 3.800184514012989*^9, {3.8001851347386627`*^9, 
   3.800185158966832*^9}, {3.8001854042827826`*^9, 3.800185410320325*^9}, {
   3.800185519222147*^9, 3.800185523689596*^9}, {3.8001896768986692`*^9, 
   3.800189722607574*^9}, {3.80137413112669*^9, 3.8013741714296255`*^9}, {
   3.8013841856315823`*^9, 3.801384188948696*^9}, {3.80140222102705*^9, 
   3.8014022330761843`*^9}, {3.801402668632842*^9, 3.8014026736149907`*^9}, {
   3.8014030679485235`*^9, 3.80140307443581*^9}, {3.8014032751715217`*^9, 
   3.8014032799327946`*^9}, {3.801403376502511*^9, 3.8014033804082546`*^9}, {
   3.8014635981704063`*^9, 3.801463599561612*^9}, 3.8019150908593993`*^9, {
   3.8019153139408197`*^9, 3.8019153165623503`*^9}, {3.8019157343606625`*^9, 
   3.801915736575409*^9}, {3.802092270773775*^9, 3.80209229608107*^9}, {
   3.8021582309780855`*^9, 3.802158251173527*^9}, {3.8026150794014177`*^9, 
   3.802615081124425*^9}, {3.802615257956793*^9, 3.802615260085367*^9}, {
   3.802615506460948*^9, 3.802615508475553*^9}, {3.802616167000297*^9, 
   3.802616174786829*^9}, {3.802616252661585*^9, 3.8026162773151073`*^9}, {
   3.802616476268402*^9, 3.802616477932734*^9}, {3.802617079516481*^9, 
   3.802617081308545*^9}, {3.8026717752847433`*^9, 3.802671778879199*^9}, {
   3.802671837294443*^9, 3.80267183740016*^9}, {3.802677551468906*^9, 
   3.802677553419702*^9}, {3.8026777106280193`*^9, 3.8026777378049173`*^9}, {
   3.8026777938392572`*^9, 3.8026777955479507`*^9}, {3.802677867498752*^9, 
   3.802677869158691*^9}, {3.802677934869171*^9, 3.802677936963346*^9}, {
   3.8026789709395103`*^9, 3.8026790152153883`*^9}, {3.802694045356523*^9, 
   3.802694046607362*^9}, {3.803194497350379*^9, 3.803194501585165*^9}, 
   3.803195091946352*^9, 3.8031962705827436`*^9, 3.80320944277538*^9, {
   3.803210030553162*^9, 3.803210031097988*^9}, {3.8043272488775377`*^9, 
   3.804327249319778*^9}, {3.804327318178566*^9, 3.804327319529335*^9}, {
   3.804328202546701*^9, 3.8043282026936626`*^9}, {3.804329703867922*^9, 
   3.8043297113445797`*^9}, {3.804331345962681*^9, 3.80433134966024*^9}, {
   3.804331399503766*^9, 3.8043314022654877`*^9}, {3.804335224119624*^9, 
   3.804335224287472*^9}, {3.804335270237255*^9, 3.8043352716135483`*^9}, {
   3.804338210413604*^9, 3.804338216173983*^9}, {3.804396876408532*^9, 
   3.804396911847794*^9}, {3.804396941971374*^9, 3.804396944498682*^9}, {
   3.804396977369413*^9, 3.804396979377389*^9}, {3.804397044362288*^9, 
   3.804397044728887*^9}, {3.804397241159913*^9, 3.804397241268517*^9}, {
   3.8043972786139927`*^9, 3.804397282810699*^9}, {3.804397644390265*^9, 
   3.8043976587651787`*^9}, {3.804397736322418*^9, 3.8043977612950077`*^9}, {
   3.804397818238163*^9, 3.80439784126*^9}, 3.8043984125991163`*^9, {
   3.804398537366918*^9, 3.804398558374385*^9}, {3.804421331607545*^9, 
   3.804421331728983*^9}, {3.80442362351309*^9, 3.804423635360736*^9}, {
   3.80442367383014*^9, 3.804423674804017*^9}, {3.804835806753974*^9, 
   3.804835849679214*^9}, {3.804836097745965*^9, 3.8048361003233433`*^9}, {
   3.8048412036989403`*^9, 3.8048412181284447`*^9}, {3.8092398820840282`*^9, 
   3.809239912036244*^9}, {3.809240067251931*^9, 3.809240069840084*^9}, {
   3.810542300423976*^9, 3.810542314524048*^9}, {3.810542367220345*^9, 
   3.810542403031006*^9}, {3.810542545862187*^9, 3.810542546320303*^9}, {
   3.810542693723102*^9, 3.810542703029853*^9}, {3.8106437003494377`*^9, 
   3.810643726463787*^9}, {3.810645263782465*^9, 3.810645277398226*^9}, {
   3.810882780943061*^9, 3.810882783629656*^9}, {3.811660130816534*^9, 
   3.811660132632793*^9}},
 CellLabel->
  "In[1854]:=",ExpressionUUID->"b25d65e0-1589-4f97-bb9b-1e69341e5ba1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"PRODUCES", " ", "t"}], "-", 
     RowBox[{"MATRIX", " ", "BLOCKS"}]}], ",", " ", 
    RowBox[{
    "CAN", " ", "BE", " ", "USED", " ", "TO", " ", "PROVE", " ", 
     "ORTHOGONALITY", " ", "OF", " ", "TALMI", " ", "COEFFICIENTS"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tBlock", "[", 
     RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]_", ",", "\[Theta]_"}], "]"}],
     ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"states", "=", 
       RowBox[{"sumArgs", "[", 
        RowBox[{"\[CapitalLambda]", ",", "\[Gamma]"}], "]"}]}], ";", "\n", 
      RowBox[{"mat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"states", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"states", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "states", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\n", 
      RowBox[{"bin", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"he", "=", "1"}], ",", 
        RowBox[{"he", "\[LessEqual]", 
         RowBox[{"Length", "[", "states", "]"}]}], ",", 
        RowBox[{"he", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"be", "=", "1"}], ",", 
          RowBox[{"be", "\[LessEqual]", 
           RowBox[{"Length", "[", "states", "]"}]}], ",", 
          RowBox[{"be", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nN", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "1", ",", "1"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"L", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "1", ",", "2"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"n", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "1", ",", "3"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"l", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "1", ",", "4"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"n1", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "2", ",", "1"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"l1", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "2", ",", "2"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"n2", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "2", ",", "3"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"l2", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", 
              RowBox[{"be", ",", "he", ",", "2", ",", "4"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"bin", ",", 
             RowBox[{
              RowBox[{"talmi", "[", 
               RowBox[{
               "n1", ",", "l1", ",", "n2", ",", "l2", ",", "nN", ",", "L", 
                ",", "n", ",", "l", ",", "\[CapitalLambda]", ",", 
                "\[Theta]"}], "]"}], "*", "1."}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"matrix", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"bin", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "states", "]"}], ",", 
           RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"matrix", ".", 
        RowBox[{"Transpose", "[", "matrix", "]"}]}], "//", "FullSimplify"}], "//",
       "MatrixForm"}], ";"}], "*)"}]}]}]], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.7977699481330757`*^9, 3.7977699671751375`*^9}, {
   3.7978581220814857`*^9, 3.7978581305966096`*^9}, {3.7978582822335143`*^9, 
   3.7978585551412187`*^9}, {3.7978593635268574`*^9, 
   3.7978593844468727`*^9}, {3.7978602476254063`*^9, 
   3.7978602521697817`*^9}, {3.7984646780058346`*^9, 3.7984646997576523`*^9}, 
   3.798533008765774*^9, 3.798869754343958*^9, 3.798869820433206*^9, {
   3.7988845166347294`*^9, 3.798884524907012*^9}, {3.7988845772009015`*^9, 
   3.7988846241711717`*^9}, {3.798955228449106*^9, 3.7989552929942265`*^9}, {
   3.798955332084936*^9, 3.7989553394586945`*^9}, {3.7989555417622023`*^9, 
   3.7989556690465393`*^9}, {3.798968125249194*^9, 3.798968128363676*^9}, {
   3.798968335412266*^9, 3.7989683587656493`*^9}, {3.7990459522427993`*^9, 
   3.7990459889508114`*^9}, {3.799135814252161*^9, 3.799135824172468*^9}, {
   3.799570524120528*^9, 3.799570532960467*^9}, {3.799989794043127*^9, 
   3.799989810171919*^9}, {3.7999917331049685`*^9, 3.799991734086523*^9}, {
   3.800102532453433*^9, 3.8001025436880198`*^9}, {3.800104098278448*^9, 
   3.800104098671193*^9}, {3.8116600917089853`*^9, 3.811660106227194*^9}, 
   3.8116614393197536`*^9},ExpressionUUID->"d9bc4a4c-16cd-4f1a-8325-\
62aa7cd0256b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"HAMILTONIAN", " ", "MATRIX", " ", "ELEMENT", " ", "LABELER"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"stateMatrix", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]Max_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Gamma]MinEven", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "\[CapitalLambda]", "]"}], ",", 
        "\[CapitalLambda]", ",", 
        RowBox[{"\[CapitalLambda]", "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]MinOdd", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "\[CapitalLambda]", "]"}], ",", 
        RowBox[{"\[CapitalLambda]", "+", "1"}], ",", "\[CapitalLambda]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"energies", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "\[Gamma]Max", "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"n", ",", 
          RowBox[{"{", 
           RowBox[{
           "n", ",", "\[Gamma]MinEven", ",", "\[Gamma]Max", ",", "2"}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"n", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "\[Gamma]MinOdd", ",", "\[Gamma]Max", ",", "2"}],
            "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"states", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"sumArgs", "[", 
         RowBox[{"\[CapitalLambda]", ",", 
          RowBox[{"energies", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"flatStates", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"states", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"matrixOfStates", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"flatStates", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"flatStates", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "flatStates", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "flatStates", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", ")"}]}]}]], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.7977699481330757`*^9, 3.7977699671751375`*^9}, {
   3.7978581220814857`*^9, 3.7978581305966096`*^9}, {3.7978582822335143`*^9, 
   3.7978585551412187`*^9}, {3.7978593635268574`*^9, 
   3.7978593844468727`*^9}, {3.7978602476254063`*^9, 
   3.7978602521697817`*^9}, {3.7984646780058346`*^9, 3.7984646997576523`*^9}, 
   3.798533008765774*^9, 3.798869754343958*^9, 3.798869820433206*^9, {
   3.7988845166347294`*^9, 3.798884524907012*^9}, {3.7988845772009015`*^9, 
   3.7988846241711717`*^9}, {3.798955228449106*^9, 3.7989552929942265`*^9}, {
   3.798955332084936*^9, 3.7989553394586945`*^9}, {3.7989555417622023`*^9, 
   3.7989556690465393`*^9}, {3.798968125249194*^9, 3.798968128363676*^9}, {
   3.798968335412266*^9, 3.7989683587656493`*^9}, {3.7990459522427993`*^9, 
   3.7990459889508114`*^9}, {3.799135814252161*^9, 3.799135824172468*^9}, {
   3.799570524120528*^9, 3.799570532960467*^9}, {3.799989794043127*^9, 
   3.799989810171919*^9}, {3.7999917331049685`*^9, 3.799991734086523*^9}, {
   3.800102532453433*^9, 3.8001025436880198`*^9}, {3.800104098278448*^9, 
   3.800104098671193*^9}, {3.8116600917089853`*^9, 3.811660106227194*^9}, {
   3.8116614393197536`*^9, 
   3.8116614496444693`*^9}},ExpressionUUID->"279f8a1f-6385-4626-8eba-\
9a60014f235f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "USE", " ", "THIS", " ", "TO", " ", "CONSTRUCT", " ", "THE", " ", "t"}], 
    "-", "MATRIX"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"tMatrix", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]Max_", ",", "\[Theta]_"}], 
    "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Gamma]MinEven", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "\[CapitalLambda]", "]"}], ",", 
        "\[CapitalLambda]", ",", 
        RowBox[{"\[CapitalLambda]", "+", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]MinOdd", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "\[CapitalLambda]", "]"}], ",", 
        RowBox[{"\[CapitalLambda]", "+", "1"}], ",", "\[CapitalLambda]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"energies", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "\[Gamma]Max", "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"n", ",", 
          RowBox[{"{", 
           RowBox[{
           "n", ",", "\[Gamma]MinEven", ",", "\[Gamma]Max", ",", "2"}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"n", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "\[Gamma]MinOdd", ",", "\[Gamma]Max", ",", "2"}],
            "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"blocks", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"tBlock", "[", 
          RowBox[{"\[CapitalLambda]", ",", "#", ",", "\[Theta]"}], "]"}], 
         "&"}], ",", "energies"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Hold", "/@", "blocks"}], "]"}], "//", "ReleaseHold"}], "//", 
      "ArrayFlatten"}]}], "\[IndentingNewLine]", ")"}]}]}]], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.7977699481330757`*^9, 3.7977699671751375`*^9}, {
   3.7978581220814857`*^9, 3.7978581305966096`*^9}, {3.7978582822335143`*^9, 
   3.7978585551412187`*^9}, {3.7978593635268574`*^9, 
   3.7978593844468727`*^9}, {3.7978602476254063`*^9, 
   3.7978602521697817`*^9}, {3.7984646780058346`*^9, 3.7984646997576523`*^9}, 
   3.798533008765774*^9, 3.798869754343958*^9, 3.798869820433206*^9, {
   3.7988845166347294`*^9, 3.798884524907012*^9}, {3.7988845772009015`*^9, 
   3.7988846241711717`*^9}, {3.798955228449106*^9, 3.7989552929942265`*^9}, {
   3.798955332084936*^9, 3.7989553394586945`*^9}, {3.7989555417622023`*^9, 
   3.7989556690465393`*^9}, {3.798968125249194*^9, 3.798968128363676*^9}, {
   3.798968335412266*^9, 3.7989683587656493`*^9}, {3.7990459522427993`*^9, 
   3.7990459889508114`*^9}, {3.799135814252161*^9, 3.799135824172468*^9}, {
   3.799570524120528*^9, 3.799570532960467*^9}, {3.799989794043127*^9, 
   3.799989810171919*^9}, {3.7999917331049685`*^9, 3.799991734086523*^9}, {
   3.800102532453433*^9, 3.8001025436880198`*^9}, {3.800104098278448*^9, 
   3.800104098671193*^9}, {3.8116600917089853`*^9, 3.811660106227194*^9}, {
   3.8116614393197536`*^9, 
   3.811661455497385*^9}},ExpressionUUID->"464326d3-9886-411e-be06-\
e94f16c8e493"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"Rcoeff", ",", "Lcoeff", ",", "ksum", ",", "rPsum", ",", "rel"}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rcoeff", "[", 
    RowBox[{"n_", ",", "l_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Rcoeff", "[", 
     RowBox[{"n", ",", "l"}], "]"}], "=", 
    RowBox[{"Sqrt", "[", 
     FractionBox[
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{"n", "!"}], ")"}]}], 
      RowBox[{"Gamma", "[", 
       RowBox[{"n", "+", "l", "+", 
        RowBox[{"3", "/", "2"}]}], "]"}]], "]"}]}]}], " "}], "\n", 
 RowBox[{
  RowBox[{"Lcoeff", "[", 
   RowBox[{"n_", ",", "l_", ",", "k_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Lcoeff", "[", 
    RowBox[{"n", ",", "l", ",", "k"}], "]"}], "=", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "k"], " ", 
     RowBox[{"Gamma", "[", 
      RowBox[{"n", "+", "l", "+", 
       RowBox[{"3", "/", "2"}]}], "]"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "k"}], ")"}], "!"}], " ", 
     RowBox[{"Gamma", "[", 
      RowBox[{"k", "+", "l", "+", 
       RowBox[{"3", "/", "2"}]}], "]"}], " ", "*", " ", 
     RowBox[{"k", "!"}]}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ksum", "[", 
   RowBox[{"n_", ",", "m_", ",", "l_", ",", "p_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ksum", "[", 
    RowBox[{"n", ",", "m", " ", ",", "l", ",", "p"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Lcoeff", "[", 
       RowBox[{"n", ",", "l", ",", "k"}], "]"}], " ", 
      RowBox[{"Lcoeff", "[", 
       RowBox[{"m", ",", "l", ",", 
        RowBox[{"p", "-", "k", "-", "l"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Max", "[", 
        RowBox[{"0", ",", 
         RowBox[{"p", "-", "l", "-", "m"}]}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"n", ",", 
         RowBox[{"p", "-", "l"}]}], "]"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rPsum", "[", 
    RowBox[{"n_", ",", "m_", ",", "l_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"rPsum", "[", 
     RowBox[{"n", ",", "m", ",", "l", ",", "y"}], "]"}], "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Gamma", "[", 
        RowBox[{"p", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], "*", "y"}], " ", "+", " ", 
         RowBox[{"3", "/", "2"}]}], "]"}], " ", "*", " ", 
       RowBox[{"ksum", "[", 
        RowBox[{"n", ",", "m", ",", "l", ",", "p"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"p", ",", "l", ",", 
        RowBox[{"l", "+", "n", "+", "m"}]}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rel", "[", 
   RowBox[{"n_", ",", "m_", ",", "l_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"rel", "[", 
    RowBox[{"n", ",", "m", ",", "l", ",", "y"}], "]"}], "=", 
   RowBox[{
    FractionBox["1", "2"], "*", 
    RowBox[{"Rcoeff", "[", 
     RowBox[{"n", ",", "l"}], "]"}], "*", 
    RowBox[{"Rcoeff", "[", 
     RowBox[{"m", ",", "l"}], "]"}], "*", 
    RowBox[{"rPsum", "[", 
     RowBox[{"n", ",", "m", ",", "l", ",", "y"}], "]"}]}]}]}]}], "Input",
 CellFrame->{{0, 0}, {0, 0}},
 CellChangeTimes->{{3.7977699481330757`*^9, 3.7977699671751375`*^9}, {
   3.7978581220814857`*^9, 3.7978581305966096`*^9}, {3.7978582822335143`*^9, 
   3.7978585551412187`*^9}, {3.7978593635268574`*^9, 
   3.7978593844468727`*^9}, {3.7978602476254063`*^9, 
   3.7978602521697817`*^9}, {3.7984646780058346`*^9, 3.7984646997576523`*^9}, 
   3.798533008765774*^9, 3.798869754343958*^9, 3.798869820433206*^9, {
   3.7988845166347294`*^9, 3.798884524907012*^9}, {3.7988845772009015`*^9, 
   3.7988846241711717`*^9}, {3.798955228449106*^9, 3.7989552929942265`*^9}, {
   3.798955332084936*^9, 3.7989553394586945`*^9}, {3.7989555417622023`*^9, 
   3.7989556690465393`*^9}, {3.798968125249194*^9, 3.798968128363676*^9}, {
   3.798968335412266*^9, 3.7989683587656493`*^9}, {3.7990459522427993`*^9, 
   3.7990459889508114`*^9}, {3.799135814252161*^9, 3.799135824172468*^9}, {
   3.799570524120528*^9, 3.799570532960467*^9}, {3.799989794043127*^9, 
   3.799989810171919*^9}, {3.7999917331049685`*^9, 3.799991734086523*^9}, {
   3.800102532453433*^9, 3.8001025436880198`*^9}, {3.800104098278448*^9, 
   3.800104098671193*^9}, {3.8116600917089853`*^9, 3.811660106227194*^9}, {
   3.8116614393197536`*^9, 
   3.811661456925645*^9}},ExpressionUUID->"cb6b9697-8f64-4f31-9877-\
730c753f9ef3"]
},
WindowSize->{1851, 1053},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowCellBracket->True,
ShowGroupOpener->False,
Magnification:>1.4 Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 36532, 869, 3737, "Input",ExpressionUUID->"b25d65e0-1589-4f97-bb9b-1e69341e5ba1"],
Cell[37093, 891, 5776, 134, 639, "Input",ExpressionUUID->"d9bc4a4c-16cd-4f1a-8325-62aa7cd0256b"],
Cell[42872, 1027, 3907, 87, 309, "Input",ExpressionUUID->"279f8a1f-6385-4626-8eba-9a60014f235f"],
Cell[46782, 1116, 3270, 72, 276, "Input",ExpressionUUID->"464326d3-9886-411e-be06-e94f16c8e493"],
Cell[50055, 1190, 4635, 120, 369, "Input",ExpressionUUID->"cb6b9697-8f64-4f31-9877-730c753f9ef3"]
}
]
*)

