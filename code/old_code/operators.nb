(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33926,        728]
NotebookOptionsPosition[     33248,        711]
NotebookOutlinePosition[     33582,        726]
CellTagsIndexPosition[     33539,        723]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"CREATES", " ", "THE", " ", "KINETIC", " ", "MATRIX"}], "  ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"kMatrix", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]Max_", ",", "\[Omega]_"}], 
    "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sM", "=", 
      RowBox[{"stateMatrix", "[", 
       RowBox[{"\[CapitalLambda]", ",", "\[Gamma]Max"}], "]"}]}], ";", "\n", 
     RowBox[{"new", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "sM", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "sM", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"np", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "1"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"lp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "2"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"l", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "2"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"nlp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "3"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"llp", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1", ",", "4"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"nl", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "3"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"ll", "=", 
           RowBox[{"sM", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "2", ",", "4"}], "]"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"qhoRho", "=", 
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"np", ",", "n"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"lp", ",", "l"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"llp", ",", "ll"}], "]"}], "*", "\[Omega]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "np"}], "+", "lp", "+", 
              FractionBox["3", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"qhoLam", "=", 
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"np", ",", "n"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"lp", ",", "l"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"llp", ",", "ll"}], "]"}], "*", "\[Omega]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "nl"}], "+", "ll", "+", 
              FractionBox["3", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"rhoSqrd", "=", 
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"lp", ",", "l"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"llp", ",", "ll"}], "]"}], "*", 
            FractionBox["1", "2"], 
            FractionBox[
             RowBox[{"\[Mu]\[Rho]", " ", 
              SuperscriptBox["\[Omega]", "2"]}], 
             SuperscriptBox["\[Alpha]", "2"]], " ", 
            RowBox[{"rel", "[", 
             RowBox[{"np", ",", "n", ",", "l", ",", "2"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"lamSqrd", "=", 
           RowBox[{
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"np", ",", "n"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"lp", ",", "l"}], "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"llp", ",", "ll"}], "]"}], "*", 
            FractionBox["1", "2"], 
            FractionBox[
             RowBox[{"\[Mu]\[Lambda]", " ", 
              SuperscriptBox["\[Omega]", "2"]}], 
             SuperscriptBox["\[Beta]", "2"]], " ", 
            RowBox[{"rel", "[", 
             RowBox[{"nlp", ",", "nl", ",", "ll", ",", "2"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"new", ",", 
            RowBox[{
            "qhoRho", "+", "qhoLam", "-", "rhoSqrd", "-", "lamSqrd"}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"new", "=", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"new", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "sM", "]"}], ",", 
          RowBox[{"Length", "[", "sM", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", ")"}]}]}]], "Input",
 CellFrame->{{0.5, 3}, {3, 0.5}},
 CellChangeTimes->{{3.798970183432444*^9, 3.7989701906112027`*^9}, {
   3.7989705659926662`*^9, 3.7989706250656056`*^9}, {3.798981730493616*^9, 
   3.798981737349745*^9}, {3.7989818148040304`*^9, 3.7989818917337112`*^9}, {
   3.7989819619160614`*^9, 3.798982008217893*^9}, {3.798982370392155*^9, 
   3.7989824472044973`*^9}, 3.7989825055048294`*^9, {3.7989829697693176`*^9, 
   3.7989829958588963`*^9}, {3.798983040894765*^9, 3.7989830620853777`*^9}, {
   3.7990461290433645`*^9, 3.7990461646120443`*^9}, {3.799046264582968*^9, 
   3.799046316938092*^9}, {3.799046351386425*^9, 3.799046361558631*^9}, {
   3.799046468435479*^9, 3.7990464759521875`*^9}, {3.7990576155288095`*^9, 
   3.799057687112938*^9}, {3.7990584731412067`*^9, 3.7990585031420803`*^9}, {
   3.7990585711722393`*^9, 3.7990586117950463`*^9}, {3.799067933546339*^9, 
   3.799067937542057*^9}, {3.799067971440709*^9, 3.7990682548189*^9}, {
   3.7990687712990537`*^9, 3.7990688211355834`*^9}, {3.7990688586791444`*^9, 
   3.799068933216592*^9}, {3.7990690230572853`*^9, 3.7990690409720583`*^9}, {
   3.7990690719273973`*^9, 3.799069120304781*^9}, {3.7990691527032757`*^9, 
   3.7990692428698044`*^9}, {3.7990694143948565`*^9, 
   3.7990695120750885`*^9}, {3.7991353341542354`*^9, 3.79913534199579*^9}, {
   3.7991372580106373`*^9, 3.7991372893437185`*^9}, {3.7991519724787855`*^9, 
   3.7991519754870667`*^9}, 3.7991520263221397`*^9, {3.7991552596321883`*^9, 
   3.7991552880479507`*^9}, {3.799406531488832*^9, 3.7994066012220187`*^9}, {
   3.7994071417244263`*^9, 3.7994071456981573`*^9}, {3.7994081961784*^9, 
   3.79940826259853*^9}, {3.799408498021118*^9, 3.7994085616427965`*^9}, {
   3.799408775954438*^9, 3.7994088555238676`*^9}, {3.7994092203455753`*^9, 
   3.7994092305897264`*^9}, {3.7994092867076874`*^9, 
   3.7994092867846427`*^9}, {3.7994093295162783`*^9, 
   3.7994093525311365`*^9}, {3.7994094118112917`*^9, 3.7994094279081*^9}, {
   3.799409511100605*^9, 3.799409511633331*^9}, {3.7994095860808263`*^9, 
   3.799409629432043*^9}, {3.7994097586922455`*^9, 3.7994097698528724`*^9}, {
   3.7994098808864813`*^9, 3.7994098817369957`*^9}, {3.7994103044276657`*^9, 
   3.7994103921535807`*^9}, {3.799411179839014*^9, 3.7994111802627726`*^9}, {
   3.799412826378006*^9, 3.7994128484424105`*^9}, {3.799478443203395*^9, 
   3.7994784440209265`*^9}, {3.7994943025755095`*^9, 3.799494321118887*^9}, {
   3.7994958456826825`*^9, 3.7994958598586035`*^9}, {3.7994970009731183`*^9, 
   3.7994970161874337`*^9}, {3.7994970777253284`*^9, 
   3.7994970790885215`*^9}, {3.8001019816878567`*^9, 3.800102027631647*^9}, {
   3.800102115061737*^9, 3.800102116654813*^9}, {3.801479265551467*^9, 
   3.801479265898269*^9}, {3.8105511329314623`*^9, 3.810551190419491*^9}, {
   3.8111377456493883`*^9, 3.8111377543530617`*^9}},
 Background->GrayLevel[0.85],
 CellLabel->"In[16]:=",ExpressionUUID->"43f3f717-56ea-4645-94a1-495276878d74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vCoulomb", "[", 
   RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]Max_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sM", "=", 
     RowBox[{"stateMatrix", "[", 
      RowBox[{"\[CapitalLambda]", ",", "\[Gamma]Max"}], "]"}]}], ";", "\n", 
    RowBox[{"new", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "sM", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "sM", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"np", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"l", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nlp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"llp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nl", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ll", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"coulomb", "=", 
          RowBox[{
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"lp", ",", "l"}], "]"}], "*", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"llp", ",", "ll"}], "]"}], "*", " ", 
           RowBox[{"rel", "[", 
            RowBox[{"np", ",", "n", ",", "l", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"new", ",", "coulomb"}], "]"}]}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"new", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"new", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "sM", "]"}], ",", 
         RowBox[{"Length", "[", "sM", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellFrame->{{0.5, 3}, {3, 0.5}},
 CellChangeTimes->{{3.798970183432444*^9, 3.7989701906112027`*^9}, {
   3.7989705659926662`*^9, 3.7989706250656056`*^9}, {3.798981730493616*^9, 
   3.798981737349745*^9}, {3.7989818148040304`*^9, 3.7989818917337112`*^9}, {
   3.7989819619160614`*^9, 3.798982008217893*^9}, {3.798982370392155*^9, 
   3.7989824472044973`*^9}, 3.7989825055048294`*^9, {3.7989829697693176`*^9, 
   3.7989829958588963`*^9}, {3.798983040894765*^9, 3.7989830620853777`*^9}, {
   3.7990461290433645`*^9, 3.7990461646120443`*^9}, {3.799046264582968*^9, 
   3.799046316938092*^9}, {3.799046351386425*^9, 3.799046361558631*^9}, {
   3.799046468435479*^9, 3.7990464759521875`*^9}, {3.7990576155288095`*^9, 
   3.799057687112938*^9}, {3.7990584731412067`*^9, 3.7990585031420803`*^9}, {
   3.7990585711722393`*^9, 3.7990586117950463`*^9}, {3.799067933546339*^9, 
   3.799067937542057*^9}, {3.799067971440709*^9, 3.7990682548189*^9}, {
   3.7990687712990537`*^9, 3.7990688211355834`*^9}, {3.7990688586791444`*^9, 
   3.799068933216592*^9}, {3.7990690230572853`*^9, 3.7990690409720583`*^9}, {
   3.7990690719273973`*^9, 3.799069120304781*^9}, {3.7990691527032757`*^9, 
   3.7990692428698044`*^9}, {3.7990694143948565`*^9, 
   3.7990695120750885`*^9}, {3.7991353341542354`*^9, 3.79913534199579*^9}, {
   3.7991372580106373`*^9, 3.7991372893437185`*^9}, {3.7991519724787855`*^9, 
   3.7991519754870667`*^9}, 3.7991520263221397`*^9, {3.7991552596321883`*^9, 
   3.7991552880479507`*^9}, {3.799406531488832*^9, 3.7994066012220187`*^9}, {
   3.7994071417244263`*^9, 3.7994071456981573`*^9}, {3.7994081961784*^9, 
   3.79940826259853*^9}, {3.799408498021118*^9, 3.7994085616427965`*^9}, {
   3.799408775954438*^9, 3.7994088555238676`*^9}, {3.7994092203455753`*^9, 
   3.7994092305897264`*^9}, {3.7994092867076874`*^9, 
   3.7994092867846427`*^9}, {3.7994093295162783`*^9, 
   3.7994093525311365`*^9}, {3.7994094118112917`*^9, 3.7994094279081*^9}, {
   3.799409511100605*^9, 3.799409511633331*^9}, {3.7994095860808263`*^9, 
   3.799409629432043*^9}, {3.7994097586922455`*^9, 3.7994097698528724`*^9}, {
   3.7994098808864813`*^9, 3.7994098817369957`*^9}, {3.7994103044276657`*^9, 
   3.7994103921535807`*^9}, {3.799411179839014*^9, 3.7994111802627726`*^9}, {
   3.799412826378006*^9, 3.7994128484424105`*^9}, {3.799478443203395*^9, 
   3.7994784440209265`*^9}, {3.799481976584279*^9, 3.7994820707880116`*^9}, {
   3.799482769322193*^9, 3.799482833046811*^9}, {3.799488747735243*^9, 
   3.799488748127037*^9}, {3.7994923512978*^9, 3.799492369204541*^9}, 
   3.7994926104603977`*^9, {3.799495886279503*^9, 3.7994959113441925`*^9}, {
   3.7994965476379747`*^9, 3.7994966250567737`*^9}, {3.7994967043554993`*^9, 
   3.7994967370708213`*^9}, {3.79949683478803*^9, 3.799496849269736*^9}, {
   3.7994969635175343`*^9, 3.799496973548794*^9}, {3.7994970182312784`*^9, 
   3.799497073700612*^9}, {3.799497174486085*^9, 3.799497174640969*^9}, {
   3.8001021233570013`*^9, 3.8001021243973775`*^9}, {3.8001022464456935`*^9, 
   3.8001022496368766`*^9}, 3.801393422907197*^9, {3.8018089932740326`*^9, 
   3.8018090055849867`*^9}, 3.8028475425792723`*^9, {3.80318587274174*^9, 
   3.8031858960372467`*^9}, {3.8031860829287453`*^9, 3.803186083244006*^9}, {
   3.803187592218954*^9, 3.8031876386325607`*^9}, {3.803187867250071*^9, 
   3.8031878803137007`*^9}, {3.803188195288999*^9, 3.8031882028327217`*^9}, {
   3.803189995668207*^9, 3.803189996173712*^9}, {3.803191477871682*^9, 
   3.803191526256135*^9}, {3.803191610487385*^9, 3.803191620666623*^9}, {
   3.803192330223893*^9, 3.803192344935964*^9}, {3.803192386669848*^9, 
   3.803192389236171*^9}, {3.803206180733526*^9, 3.803206209735867*^9}, {
   3.803209135900094*^9, 3.803209181127075*^9}, {3.803209229853613*^9, 
   3.803209235318331*^9}, {3.8044798651058483`*^9, 3.804479912736249*^9}, {
   3.804480152288588*^9, 3.8044801585185843`*^9}, {3.81097481098875*^9, 
   3.810974812535123*^9}, {3.8111377619187403`*^9, 3.811137769286189*^9}, {
   3.8111385292683563`*^9, 3.811138531853129*^9}, {3.811138581548727*^9, 
   3.811138585030353*^9}, {3.8115762234771643`*^9, 3.81157627903648*^9}, {
   3.811577175089614*^9, 3.8115772842035017`*^9}, {3.811577343460177*^9, 
   3.811577370741974*^9}, {3.811586214365539*^9, 3.811586252358947*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[941]:=",ExpressionUUID->"dc85d82d-16af-4fe3-9bba-d5542387b6f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vLinear", "[", 
   RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]Max_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sM", "=", 
     RowBox[{"stateMatrix", "[", 
      RowBox[{"\[CapitalLambda]", ",", "\[Gamma]Max"}], "]"}]}], ";", "\n", 
    RowBox[{"new", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "sM", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "sM", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"np", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"l", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nlp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"llp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nl", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ll", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"linear", "=", 
          RowBox[{
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"lp", ",", "l"}], "]"}], "*", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"llp", ",", "ll"}], "]"}], "*", " ", 
           RowBox[{"rel", "[", 
            RowBox[{"np", ",", "n", ",", "l", ",", "1"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"new", ",", "linear"}], "]"}]}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"new", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"new", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "sM", "]"}], ",", 
         RowBox[{"Length", "[", "sM", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellFrame->{{0.5, 3}, {3, 0.5}},
 CellChangeTimes->{{3.798970183432444*^9, 3.7989701906112027`*^9}, {
   3.7989705659926662`*^9, 3.7989706250656056`*^9}, {3.798981730493616*^9, 
   3.798981737349745*^9}, {3.7989818148040304`*^9, 3.7989818917337112`*^9}, {
   3.7989819619160614`*^9, 3.798982008217893*^9}, {3.798982370392155*^9, 
   3.7989824472044973`*^9}, 3.7989825055048294`*^9, {3.7989829697693176`*^9, 
   3.7989829958588963`*^9}, {3.798983040894765*^9, 3.7989830620853777`*^9}, {
   3.7990461290433645`*^9, 3.7990461646120443`*^9}, {3.799046264582968*^9, 
   3.799046316938092*^9}, {3.799046351386425*^9, 3.799046361558631*^9}, {
   3.799046468435479*^9, 3.7990464759521875`*^9}, {3.7990576155288095`*^9, 
   3.799057687112938*^9}, {3.7990584731412067`*^9, 3.7990585031420803`*^9}, {
   3.7990585711722393`*^9, 3.7990586117950463`*^9}, {3.799067933546339*^9, 
   3.799067937542057*^9}, {3.799067971440709*^9, 3.7990682548189*^9}, {
   3.7990687712990537`*^9, 3.7990688211355834`*^9}, {3.7990688586791444`*^9, 
   3.799068933216592*^9}, {3.7990690230572853`*^9, 3.7990690409720583`*^9}, {
   3.7990690719273973`*^9, 3.799069120304781*^9}, {3.7990691527032757`*^9, 
   3.7990692428698044`*^9}, {3.7990694143948565`*^9, 
   3.7990695120750885`*^9}, {3.7991353341542354`*^9, 3.79913534199579*^9}, {
   3.7991372580106373`*^9, 3.7991372893437185`*^9}, {3.7991519724787855`*^9, 
   3.7991519754870667`*^9}, 3.7991520263221397`*^9, {3.7991552596321883`*^9, 
   3.7991552880479507`*^9}, {3.799406531488832*^9, 3.7994066012220187`*^9}, {
   3.7994071417244263`*^9, 3.7994071456981573`*^9}, {3.7994081961784*^9, 
   3.79940826259853*^9}, {3.799408498021118*^9, 3.7994085616427965`*^9}, {
   3.799408775954438*^9, 3.7994088555238676`*^9}, {3.7994092203455753`*^9, 
   3.7994092305897264`*^9}, {3.7994092867076874`*^9, 
   3.7994092867846427`*^9}, {3.7994093295162783`*^9, 
   3.7994093525311365`*^9}, {3.7994094118112917`*^9, 3.7994094279081*^9}, {
   3.799409511100605*^9, 3.799409511633331*^9}, {3.7994095860808263`*^9, 
   3.799409629432043*^9}, {3.7994097586922455`*^9, 3.7994097698528724`*^9}, {
   3.7994098808864813`*^9, 3.7994098817369957`*^9}, {3.7994103044276657`*^9, 
   3.7994103921535807`*^9}, {3.799411179839014*^9, 3.7994111802627726`*^9}, {
   3.799412826378006*^9, 3.7994128484424105`*^9}, {3.799478443203395*^9, 
   3.7994784440209265`*^9}, {3.799481976584279*^9, 3.7994820707880116`*^9}, {
   3.799482769322193*^9, 3.799482833046811*^9}, {3.799488747735243*^9, 
   3.799488748127037*^9}, {3.7994923512978*^9, 3.799492369204541*^9}, 
   3.7994926104603977`*^9, {3.799495886279503*^9, 3.7994959113441925`*^9}, {
   3.7994965476379747`*^9, 3.7994966250567737`*^9}, {3.7994967043554993`*^9, 
   3.7994967370708213`*^9}, {3.79949683478803*^9, 3.799496849269736*^9}, {
   3.7994969635175343`*^9, 3.799496973548794*^9}, {3.7994970182312784`*^9, 
   3.799497073700612*^9}, {3.799497174486085*^9, 3.799497174640969*^9}, {
   3.8001021233570013`*^9, 3.8001021243973775`*^9}, {3.8001022464456935`*^9, 
   3.8001022496368766`*^9}, 3.801393422907197*^9, {3.8018089932740326`*^9, 
   3.8018090055849867`*^9}, 3.8028475425792723`*^9, {3.80318587274174*^9, 
   3.8031858960372467`*^9}, {3.8031860829287453`*^9, 3.803186083244006*^9}, {
   3.803187592218954*^9, 3.8031876386325607`*^9}, {3.803187867250071*^9, 
   3.8031878803137007`*^9}, {3.803188195288999*^9, 3.8031882028327217`*^9}, {
   3.803189995668207*^9, 3.803189996173712*^9}, {3.803191477871682*^9, 
   3.803191526256135*^9}, {3.803191610487385*^9, 3.803191620666623*^9}, {
   3.803192330223893*^9, 3.803192344935964*^9}, {3.803192386669848*^9, 
   3.803192389236171*^9}, {3.803206180733526*^9, 3.803206209735867*^9}, {
   3.803209135900094*^9, 3.803209181127075*^9}, {3.803209229853613*^9, 
   3.803209235318331*^9}, {3.8044798651058483`*^9, 3.804479912736249*^9}, {
   3.804480152288588*^9, 3.8044801585185843`*^9}, {3.81097481098875*^9, 
   3.810974812535123*^9}, {3.8111377619187403`*^9, 3.811137769286189*^9}, {
   3.8111385292683563`*^9, 3.811138531853129*^9}, {3.811138581548727*^9, 
   3.811138585030353*^9}, {3.8115762234771643`*^9, 3.81157627903648*^9}, {
   3.811577175089614*^9, 3.8115772842035017`*^9}, {3.811577343460177*^9, 
   3.811577370741974*^9}, {3.811586230735084*^9, 3.811586266120042*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[942]:=",ExpressionUUID->"1116d3de-59cf-4857-9cf6-05cdbc239ee7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vZeroSho", "[", 
   RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]Max_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sM", "=", 
     RowBox[{"stateMatrix", "[", 
      RowBox[{"\[CapitalLambda]", ",", "\[Gamma]Max"}], "]"}]}], ";", "\n", 
    RowBox[{"new0", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "sM", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "sM", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"np", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"l", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nlp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"llp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nl", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ll", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rho", "=", 
          RowBox[{
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"lp", ",", "l"}], "]"}], "*", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"llp", ",", "ll"}], "]"}], "*", 
           RowBox[{"rel", "[", 
            RowBox[{"np", ",", "n", ",", "l", ",", "2"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lam", "=", 
          RowBox[{
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"lp", ",", "l"}], "]"}], "*", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"np", ",", "n"}], "]"}], "*", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"llp", ",", "ll"}], "]"}], "*", " ", 
           RowBox[{"rel", "[", 
            RowBox[{"nlp", ",", "nl", ",", "ll", ",", "2"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"new0", ",", 
           RowBox[{
            FractionBox[
             RowBox[{"7", " ", "lam"}], "10"], "+", 
            FractionBox[
             RowBox[{"4", " ", "rho"}], "5"]}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"new0", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"new0", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "sM", "]"}], ",", 
         RowBox[{"Length", "[", "sM", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellFrame->{{0.5, 3}, {3, 0.5}},
 CellChangeTimes->{{3.8105414463928747`*^9, 3.810541523542395*^9}, {
  3.810542155752103*^9, 3.810542184993855*^9}, {3.810550995568426*^9, 
  3.8105510517925386`*^9}, {3.810974809232579*^9, 3.810974817265153*^9}, {
  3.811137773150576*^9, 3.811137779070462*^9}, {3.811138842030764*^9, 
  3.811138842420351*^9}, {3.811244704728354*^9, 3.811244715574664*^9}, {
  3.811246232033057*^9, 3.811246242601316*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[282]:=",ExpressionUUID->"4f5e6f67-7785-4c80-a41d-7b79e911ee31"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vTalmi", "[", 
   RowBox[{"\[CapitalLambda]_", ",", "\[Gamma]Max_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sM", "=", 
     RowBox[{"stateMatrix", "[", 
      RowBox[{"\[CapitalLambda]", ",", "\[Gamma]Max"}], "]"}]}], ";", "\n", 
    RowBox[{"newTalmi", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "sM", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "sM", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"np", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"l", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nlp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"llp", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "1", ",", "4"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nl", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "3"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ll", "=", 
          RowBox[{"sM", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "2", ",", "4"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rho", "=", 
          RowBox[{
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"lp", ",", "l"}], "]"}], "*", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"nlp", ",", "nl"}], "]"}], "*", 
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"llp", ",", "ll"}], "]"}], "*", " ", 
           RowBox[{"rel", "[", 
            RowBox[{"np", ",", "n", ",", "l", ",", "2"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"newTalmi", ",", "rho"}], "]"}]}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"newTalmi", "=", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"newTalmi", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "sM", "]"}], ",", 
         RowBox[{"Length", "[", "sM", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellFrame->{{0.5, 3}, {3, 0.5}},
 CellChangeTimes->{{3.8105414512083073`*^9, 3.810541452210082*^9}, {
  3.810541512570942*^9, 3.81054153978305*^9}, {3.811137783495623*^9, 
  3.811137789522304*^9}},
 Background->GrayLevel[0.85],
 CellLabel->
  "In[283]:=",ExpressionUUID->"82890cdf-95c4-4233-bb96-71ec822c4a4f"]
},
WindowSize->{1851, 1053},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 8838, 185, 722, "Input",ExpressionUUID->"43f3f717-56ea-4645-94a1-495276878d74"],
Cell[9399, 207, 7787, 146, 466, "Input",ExpressionUUID->"dc85d82d-16af-4fe3-9bba-d5542387b6f6"],
Cell[17189, 355, 7765, 146, 466, "Input",ExpressionUUID->"1116d3de-59cf-4857-9cf6-05cdbc239ee7"],
Cell[24957, 503, 4579, 112, 561, "Input",ExpressionUUID->"4f5e6f67-7785-4c80-a41d-7b79e911ee31"],
Cell[29539, 617, 3705, 92, 466, "Input",ExpressionUUID->"82890cdf-95c4-4233-bb96-71ec822c4a4f"]
}
]
*)

